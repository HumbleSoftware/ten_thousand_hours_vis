
typeof Humble=="undefined"&&(Humble={}),typeof Humble.Vis=="undefined"&&(Humble.Vis={}),function(){function a(a){this.data=a}a.prototype={bound:function(a,b){if(!_.isNumber(a)||!_.isNumber(b))return this;var c=this.data,d=c.length,e=[],f;for(f=0;f<d;f++)if(c[f][0]>=a)break;f>0&&f--;for(f;f<d;f++){e.push(c[f]);if(c[f][0]>b)break}return this.data=e,this},subsampleMinMax:function(a){var b=this.data,c=b.length,d=c-1,e=[],f=a/c,g=Math.round(f*1),h=1,i=1,j,k,l,m,n;if(c>a){e.push(b[0]);for(m=1;m<d;m++)n=Math.round(f*m),n!==g?(i===h?e.push(b[h]):e.push(b[Math.min(h,i)],b[Math.max(h,i)]),h=i=m,j=k=b[m][1],g=n):(l=b[m][1],l<j&&(h=m,j=l),l>k&&(i=m,k=l));e.push(b[c-1]),this.data=e}return this},subsample:function(a){var b=this.data,c=b.length,d=[],e=c/a,f;if(c>a){d.push(b[0]);for(f=1;f<a;f++){if(f*e>=c)break;d.push(b[Math.round(f*e)])}d.push(b[c-1]),this.data=d}return this}},Humble.Vis.Data=a}(),function(){function d(a){this.options=a||{},this.children=[],this.container=null,this.rendered=!1}var a="humble-vis-first",b="humble-vis-last",c='<div class="humble-vis-visualization"></div>';d.prototype={render:function(a){var b=this.options;a=a||b.element;if(!a)throw"No element to render within.";this.container=bonzo.create(c),bonzo(a).append(this.container),_.each(this.children,function(a){a.render(this.container)},this),this._updateClasses(),this.rendered=!0},add:function(a){return this.children.push(a),this.rendered&&(a.render(this.container),this._updateClasses()),a},remove:function(a){var b=this.children,c=this.indexOf(a);if(c!==-1)return b.splice(c,1),bonzo(a.node).remove(),this._updateClasses(),!0},setPosition:function(a,b){var c=this.children;if(b>=0&&b<c.length&&this.remove(a))return b===c.length?bonzo(this.container).append(a.node):this.container[0].insertBefore(a.node[0],c[b].node[0]),c.splice(b,0,a),this._updateClasses(),!0},indexOf:function(a){return _.indexOf(this.children,a)},getChild:function(a){var b=this.children;if(a<b.length)return b[a]},isFirst:function(a){return this.indexOf(a)===0?!0:!1},isLast:function(a){return this.indexOf(a)===this.children.length-1?!0:!1},_updateClasses:function(){var c=this.children,d=0,e=c.length-1,f;_.each(c,function(c,g){f=bonzo(c.node),g===d?f.addClass(a):f.removeClass(a),g===e?f.addClass(b):f.removeClass(b)})}},Humble.Vis.Visualization=d}(),function(){function b(a){this.options=a=a||{},this.actions=[],this.followers=[],this.leaders=[],a.leader&&this.lead(a.leader)}var a=Flotr.EventAdapter;b.prototype={getLeaders:function(){return this.leaders},getFollowers:function(){return this.followers},getActions:function(){return this.actions},lead:function(a){this.leaders.push(a),_.each(this.actions,function(b){this._bindLeader(a,b)},this)},follow:function(a){this.followers.push(a)},group:function(a){_.isArray(a)||(a=[a]),_.each(a,function(a){this.lead(a),this.follow(a)},this)},add:function(a){this.actions.push(a),_.each(this.leaders,function(b){this._bindLeader(b,a)},this)},_bindLeader:function(b,c){_.each(c.events,function(d,e){a.observe(b.container,e,_.bind(c[d],this,b))},this)}},Humble.Vis.Interaction=b}(),function(){var a={events:{"flotr:select":"zoom","flotr:click":"reset"},zoom:function(a,b){var c=a.getData(),d=b.x1,e=b.x2,f;f={xaxis:{min:d,max:e}},_.each(this.followers,function(a){a.draw(null,f)},this)},reset:function(){var a=this.leaders[0],b=a.flotr.axes.x.min,c=a.flotr.axes.x.max,d={xaxis:{min:b,max:c}};_.each(this.followers,function(a){a.draw(null,d)},this)}};Humble.Vis.Action={},Humble.Vis.Action.Selection=a}(),function(){var a={events:{"flotr:hit":"hit",mouseout:"reset"},hit:function(a,b){if(this._preventHit)return;this._preventHit=!0;var c=b.index,d=b.x,e,f,g,h,i;_.each(this.followers,function(b){if(a===b)return;f=b.flotr,g={relX:f.axes.x.d2p(d),relY:1},f.hit.hit(g)},this),this._preventHit=!1},reset:function(){_.each(this.followers,function(a){a.flotr.hit.clearHit()},this)}};Humble.Vis.Action.Hit=a}(),Humble.Vis.flotr={},Humble.Vis.flotr.defaultOptions={grid:{outlineWidth:0,labelMargin:0,horizontalLines:!1,verticalLines:!1},bars:{show:!1,barWidth:.5,fill:!0,lineWidth:2,fillOpacity:1},lines:{lineWidth:1},xaxis:{margin:!1,tickDecimals:0,showLabels:!1},yaxis:{margin:!1,showLabels:!1},shadowSize:!1},function(){function f(a){this.options=a||{},this.container=bonzo.create(d)[0],this.node=bonzo.create(c),a.name&&bonzo(this.node).addClass(a.name),bonzo(this.node).append(this.container),this.flotr=null,this._flotrDefaultOptions()}var a=Humble.Vis,b="humble-vis-child",c='<div class="'+b+'"></div>',d='<div class="'+b+'-container"></div>',e=Humble.Vis.flotr.defaultOptions;f.prototype={getFlotr:function(){return this.flotr},getData:function(){return this.options.data},render:function(a){var b=this.options;if(!a)throw"No element to render within.";if(!b.width)throw"No width.";if(!b.height)throw"No height.";bonzo(a).append(this.node),bonzo(this.container).css({width:b.width,height:b.height}),this.draw(b.data,b.flotr)},draw:function(a,b){var c=this.options,b=_.clone(b),a=a||c.data,d=[],e=this.container;b&&(_.extend(c.flotr,b),this._flotrDefaultOptions(b)),b=c.flotr,c.data=a,min=b.xaxis.min,max=b.xaxis.max,a=this._getDataArray(a),c.skipPreprocess?d=a:_.each(a,function(a,b){!_.isArray(a)&&!_.isFunction(a)?(d[b]=_.clone(a),d[b]=this._processData(a.data)):d[b]=this._processData(a)},this);if(!b)throw"No graph submitted.";this.flotr=Flotr.draw(e,d,b)},getNode:function(){return this.node},_processData:function(b){var c=this.options,d=c.processData,e=c.width,f=c.flotr.xaxis,g=f.min,h=f.max,i=new a.Data(b);return _.isFunction(b)?b(g,h,e):(d?d.apply(this,[{datum:i,min:g,max:h,resolution:e}]):i.bound(g,h).subsampleMinMax(e),i.data)},_getDataArray:function(a){return a[0]&&(!_.isArray(a[0])||a[0][0]&&_.isArray(a[0][0]))?a:[a]},_flotrDefaultOptions:function(a){var b=a||this.options.flotr,c;for(c in e)_.isUndefined(b[c])?b[c]=e[c]:_.defaults(b[c],e[c])}},Humble.Vis.Child=f}()