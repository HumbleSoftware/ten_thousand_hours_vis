/*!
  * bean.js - copyright Jacob Thornton 2011
  * https://github.com/fat/bean
  * MIT License
  * special thanks to:
  * dean edwards: http://dean.edwards.name/
  * dperini: https://github.com/dperini/nwevents
  * the entire mootools team: github.com/mootools/mootools-core
  */
!function(a){function F(a){var b=a.relatedTarget;return b?b!=this&&b.prefix!="xul"&&!/document/.test(this.toString())&&!p(this,b):b===null}var b=1,c={},d={},e=/over|out/,f=/[^\.]*(?=\..*)\.|.*/,g=/\..*/,h="addEventListener",i="attachEvent",j="removeEventListener",k="detachEvent",l=a.document||{},m=l.documentElement||{},n=m[h],o=n?h:i,p=function(a,b){var c=b.parentNode;while(c!==null){if(c==a)return!0;c=c.parentNode}},q=function(a,c){return a.__uid=c||a.__uid||b++},r=function(a){var b=q(a);return c[b]=c[b]||{}},s=n?function(a,b,c,d){a[d?h:j](b,c,!1)}:function(a,b,c,d,e){e&&d&&(a["_on"+e]=a["_on"+e]||0),a[d?i:k]("on"+b,c)},t=function(b,c,d){return function(e){e=D(e||((this.ownerDocument||this.document||this).parentWindow||a).event);return c.apply(b,[e].concat(d))}},u=function(a,b,c,d,e){return function(f){(d?d.apply(this,arguments):n?!0:f&&f.propertyName=="_on"+c||!f)&&b.apply(a,Array.prototype.slice.call(arguments,f?0:1).concat(e))}},v=function(a,b,c,e){var h=b.replace(g,""),i=r(a),j=i[h]||(i[h]={}),k=c,l=q(c,b.replace(f,""));if(j[l])return a;var m=G[h];m&&(c=m.condition?u(a,c,h,m.condition):c,h=m.base||h);var p=E[h];c=p?t(a,c,e):u(a,c,h,!1,e),p=n||p;if(h=="unload"){var v=c;c=function(){w(a,h,c)&&v()}}a[o]&&s(a,p?h:"propertychange",c,!0,!p&&h),j[l]=c,c.__uid=l,c.__originalFn=k;return h=="unload"?a:d[q(a)]=a},w=function(a,b,c){var d,e,h,i,j=r(a),k=b.replace(g,"");if(!j||!j[k])return a;e=b.replace(f,""),h=e?e.split("."):[c.__uid];for(i=h.length;i--;){d=h[i],c=j[k][d],delete j[k][d];if(a[o]){k=G[k]?G[k].base:k;var l=n||E[k];s(a,l?k:"propertychange",c,!1,!l&&k)}}return a},x=function(a,b,c){return function(d){var e=typeof a=="string"?c(a,this):a;for(var f=d.target;f&&f!=this;f=f.parentNode)for(var g=e.length;g--;)if(e[g]==f)return b.apply(f,arguments)}},y=function(a,b,c,d,e){if(typeof b=="object"&&!c)for(var f in b)b.hasOwnProperty(f)&&y(a,f,b[f]);else{var g=typeof c=="string",h=(g?c:b).split(" ");c=g?x(b,d,e):c;for(var i=h.length;i--;)v(a,h[i],c,Array.prototype.slice.call(arguments,g?4:3))}return a},z=function(a,b,c){var d,e,h,i,j=typeof b=="string",k=j&&b.replace(f,""),l=w,m=r(a);if(j&&/\s/.test(b)){b=b.split(" "),i=b.length-1;while(z(a,b[i])&&i--);return a}h=j?b.replace(g,""):b;if(!m||j&&!m[h]){if(m&&k)for(d in m)if(m.hasOwnProperty(d))for(i in m[d])m[d].hasOwnProperty(i)&&i===k&&l(a,[d,k].join("."));return a}if(typeof c=="function")l(a,h,c);else if(k)l(a,b);else{l=h?l:z,e=j&&h,h=h?c||m[h]||h:m;for(d in h)h.hasOwnProperty(d)&&(l(a,e||d,h[d]),delete h[d])}return a},A=function(a,b,c){var d,e,h,i=b.split(" ");for(h=i.length;h--;){b=i[h].replace(g,"");var j=E[b],k=i[h].replace(f,""),l=r(a)[b];if(k){k=k.split(".");for(e=k.length;e--;)l&&l[k[e]]&&l[k[e]].apply(a,[!1].concat(c))}else if(!c&&a[o])B(j,b,a);else for(e in l)l.hasOwnProperty(e)&&l[e].apply(a,[!1].concat(c))}return a},B=n?function(b,c,d){evt=document.createEvent(b?"HTMLEvents":"UIEvents"),evt[b?"initEvent":"initUIEvent"](c,!0,!0,a,1),d.dispatchEvent(evt)}:function(a,b,c){a?c.fireEvent("on"+b,document.createEventObject()):c["_on"+b]++},C=function(a,b,c){var d=r(b),e,f,g=q(a);e=c?d[c]:d;for(f in e)e.hasOwnProperty(f)&&(c?y:C)(a,c||b,c?e[f].__originalFn:f);return a},D=function(a){var b={};if(!a)return b;var c=a.type,d=a.target||a.srcElement;b.preventDefault=D.preventDefault(a),b.stopPropagation=D.stopPropagation(a),b.target=d&&d.nodeType==3?d.parentNode:d;if(~c.indexOf("key"))b.keyCode=a.which||a.keyCode;else if(/click|mouse|menu/i.test(c)){b.rightClick=a.which==3||a.button==2,b.pos={x:0,y:0};if(a.pageX||a.pageY)b.clientX=a.pageX,b.clientY=a.pageY;else if(a.clientX||a.clientY)b.clientX=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,b.clientY=a.clientY+document.body.scrollTop+document.documentElement.scrollTop;e.test(c)&&(b.relatedTarget=a.relatedTarget||a[(c=="mouseover"?"from":"to")+"Element"])}for(var f in a)f in b||(b[f]=a[f]);return b};D.preventDefault=function(a){return function(){a.preventDefault?a.preventDefault():a.returnValue=!1}},D.stopPropagation=function(a){return function(){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}};var E={click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1},G={mouseenter:{base:"mouseover",condition:F},mouseleave:{base:"mouseout",condition:F},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}},H={add:y,remove:z,clone:C,fire:A},I=function(a){var b=z(a).__uid;b&&(delete d[b],delete c[b])};a[i]&&y(a,"unload",function(){for(var b in d)d.hasOwnProperty(b)&&I(d[b]);a.CollectGarbage&&CollectGarbage()});var J=a.bean;H.noConflict=function(){a.bean=J;return this},typeof module!="undefined"&&module.exports?module.exports=H:a.bean=H}(this),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new B(a)};typeof module!="undefined"&&module.exports?(module.exports=w,w._=w):a._=w,w.VERSION="1.1.7";var x=w.each=w.forEach=function(a,b,d){if(a!=null)if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(j.call(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=function(a,b,c){var d=[];if(a==null)return d;if(l&&a.map===l)return a.map(b,c);x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)});return d},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=c!==void 0;a==null&&(a=[]);if(m&&a.reduce===m){d&&(b=w.bind(b,d));return e?a.reduce(b,c):a.reduce(b)}x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){a==null&&(a=[]);if(n&&a.reduceRight===n){d&&(b=w.bind(b,d));return c!==void 0?a.reduceRight(b,c):a.reduceRight(b)}var e=(w.isArray(a)?a.slice():w.toArray(a)).reverse();return w.reduce(e,b,c,d)},w.find=w.detect=function(a,b,c){var d;y(a,function(a,e,f){if(b.call(c,a,e,f)){d=a;return!0}});return d},w.filter=w.select=function(a,b,c){var d=[];if(a==null)return d;if(o&&a.filter===o)return a.filter(b,c);x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)});return d},w.reject=function(a,b,c){var d=[];if(a==null)return d;x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)});return d},w.every=w.all=function(a,b,d){var e=!0;if(a==null)return e;if(p&&a.every===p)return a.every(b,d);x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c});return e};var y=w.some=w.any=function(a,b,d){b=b||w.identity;var e=!1;if(a==null)return e;if(q&&a.some===q)return a.some(b,d);x(a,function(a,f,g){if(e|=b.call(d,a,f,g))return c});return!!e};w.include=w.contains=function(a,b){var c=!1;if(a==null)return c;if(r&&a.indexOf===r)return a.indexOf(b)!=-1;y(a,function(a){if(c=a===b)return!0});return c},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);var d={computed:-Infinity};x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})});return d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);var d={computed:Infinity};x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})});return d.value},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={};x(a,function(a,d){var e=b(a,d);(c[e]||(c[e]=[])).push(a)});return c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.last=function(a){return a[a.length-1]},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a){return w.reduce(a,function(a,b){if(w.isArray(b))return a.concat(w.flatten(b));a[a.length]=b;return a},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b){return w.reduce(a,function(a,c,d){if(0==d||(b===!0?w.last(a)!=c:!w.include(a,c)))a[a.length]=c;return a},[])},w.union=function(){return w.uniq(w.flatten(arguments))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a,b){return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c){d=w.sortedIndex(a,b);return a[d]===b?d:-1}if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);while(e<d)f[e++]=a,a+=c;return f},w.bind=function(a,b){if(a.bind===v&&v)return v.apply(a,g.call(arguments,1));var c=g.call(arguments,2);return function(){return a.apply(b,c.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)});return a},w.memoize=function(a,b){var c={};b||(b=w.identity);return function(){var d=b.apply(this,arguments);return j.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))};var z=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}};w.throttle=function(a,b){return z(a,b,!1)},w.debounce=function(a,b){return z(a,b,!0)},w.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments));return b.apply(this,c)}},w.compose=function(){var a=g.call(arguments);return function(){var b=g.call(arguments);for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)j.call(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){x(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])});return a},w.defaults=function(a){x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])});return a},w.clone=function(a){return w.isArray(a)?a.slice():w.extend({},a)},w.tap=function(a,b){b(a);return a},w.isEqual=function(a,b){if(a===b)return!0;var c=typeof a,d=typeof b;if(c!=d)return!1;if(a==b)return!0;if(!a&&b||a&&!b)return!1;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual)return a.isEqual(b);if(b.isEqual)return b.isEqual(a);if(w.isDate(a)&&w.isDate(b))return a.getTime()===b.getTime();if(w.isNaN(a)&&w.isNaN(b))return!1;if(w.isRegExp(a)&&w.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(c!=="object")return!1;if(a.length&&a.length!==b.length)return!1;var e=w.keys(a),f=w.keys(b);if(e.length!=f.length)return!1;for(var g in a)if(!(g in b)||!w.isEqual(a[g],b[g]))return!1;return!0},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(j.call(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)==="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return!!a&&!!j.call(a,"callee")},w.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},w.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)},w.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1},w.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)},w.isRegExp=function(a){return!(!(a&&a.test&&a.exec)||!a.ignoreCase&&a.ignoreCase!==!1)},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.noConflict=function(){a._=b;return this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.mixin=function(a){x(w.functions(a),function(b){D(b,w[b]=a[b])})};var A=0;w.uniqueId=function(a){var b=A++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj",d);return b?e(b):e};var B=function(a){this._wrapped=a};w.prototype=B.prototype;var C=function(a,b){return b?w(a).chain():a},D=function(a,b){B.prototype[a]=function(){var a=g.call(arguments);h.call(a,this._wrapped);return C(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];B.prototype[a]=function(){b.apply(this._wrapped,arguments);return C(this._wrapped,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];B.prototype[a]=function(){return C(b.apply(this._wrapped,arguments),this._chain)}}),B.prototype.chain=function(){this._chain=!0;return this},B.prototype.value=function(){return this._wrapped}}();var Canvas2Image=function(){var a=document.createElement("canvas"),b=String.fromCharCode,c="image/octet-stream",d=!1;if(!a.getContext)return{saveAsBMP:function(){},saveAsPNG:function(){},saveAsJPEG:function(){}};var e=!!a.getContext("2d").getImageData,f=!!a.toDataURL,g=!!window.btoa,h=function(a){var b=parseInt(a.width),c=parseInt(a.height);return a.getContext("2d").getImageData(0,0,b,c)},i=function(a){var c,d,e="";if(typeof a=="string")e=a;else{d=a;for(c=0;c<d.length;c++)e+=b(d[c])}return btoa(e)},j=function(a){var c="",d=a.width,e=a.height;c+="BM";var f=d*e*4+54;c+=b(f%256),f=Math.floor(f/256),c+=b(f%256),f=Math.floor(f/256),c+=b(f%256),f=Math.floor(f/256),c+=b(f%256),c+=b(0,0,0,0,54,0,0,0),c+=b(40,0,0,0);var g=d;c+=b(g%256),g=Math.floor(g/256),c+=b(g%256),g=Math.floor(g/256),c+=b(g%256),g=Math.floor(g/256),c+=b(g%256);var h=e;c+=b(h%256),h=Math.floor(h/256),c+=b(h%256),h=Math.floor(h/256),c+=b(h%256),h=Math.floor(h/256),c+=b(h%256),c+=b(1,0,32,0),c+=b(0,0,0,0);var j=d*e*4;c+=b(j%256),j=Math.floor(j/256),c+=b(j%256),j=Math.floor(j/256),c+=b(j%256),j=Math.floor(j/256),c+=b(j%256),c+=b(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var k=a.data,l="",m,n,o=e,p,q,r;do{q=d*(o-1)*4,r="";for(n=0;n<d;n++)p=4*n,r+=b(k[q+p+2],k[q+p+1],k[q+p],k[q+p+3]);l+=r}while(--o);return i(c+l)},k=function(a){window.open(a)||(document.location.href=a)},l=function(a,b){return"data:"+b+";base64,"+a},m=function(a){var b=document.createElement("img");b.src=a;return b},n=function(a,b,c){if(b&&c){var d=document.createElement("canvas");d.width=b,d.height=c,d.style.width=b+"px",d.style.height=c+"px";var e=d.getContext("2d");e.drawImage(a,0,0,a.width,a.height,0,0,b,b);return d}return a};return{saveAsPNG:function(a,b,e,g){if(!f)return!1;var h=n(a,e,g),i="image/png",j=h.toDataURL(i);if(b)return m(j);k(d?j.replace(i,c):j);return!0},saveAsJPEG:function(a,b,e,g){if(!f)return!1;var h=n(a,e,g),i="image/jpeg",j=h.toDataURL(i);if(j.indexOf(i)!=5)return!1;if(b)return m(j);k(d?j.replace(i,c):j);return!0},saveAsBMP:function(a,b,c,d){if(!(f&&e&&g))return!1;var i=n(a,c,d),o="image/bmp",p=h(i),q=j(p);if(b)return m(l(q,o));k(l(q,o));return!0}}}(),CanvasText={letters:{"\n":{width:-1,points:[]}," ":{width:10,points:[]},"!":{width:10,points:[[5,21],[5,7],null,[5,2],[4,1],[5,0],[6,1],[5,2]]},'"':{width:16,points:[[4,21],[4,14],null,[12,21],[12,14]]},"#":{width:21,points:[[11,25],[4,-7],null,[17,25],[10,-7],null,[4,12],[18,12],null,[3,6],[17,6]]},$:{width:20,points:[[8,25],[8,-4],null,[12,25],[12,-4],null,[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},"%":{width:24,points:[[21,21],[3,0],null,[8,21],[10,19],[10,17],[9,15],[7,14],[5,14],[3,16],[3,18],[4,20],[6,21],[8,21],null,[17,7],[15,6],[14,4],[14,2],[16,0],[18,0],[20,1],[21,3],[21,5],[19,7],[17,7]]},"&":{width:26,points:[[23,12],[23,13],[22,14],[21,14],[20,13],[19,11],[17,6],[15,3],[13,1],[11,0],[7,0],[5,1],[4,2],[3,4],[3,6],[4,8],[5,9],[12,13],[13,14],[14,16],[14,18],[13,20],[11,21],[9,20],[8,18],[8,16],[9,13],[11,10],[16,3],[18,1],[20,0],[22,0],[23,1],[23,2]]},"'":{width:10,points:[[5,19],[4,20],[5,21],[6,20],[6,18],[5,16],[4,15]]},"(":{width:14,points:[[11,25],[9,23],[7,20],[5,16],[4,11],[4,7],[5,2],[7,-2],[9,-5],[11,-7]]},")":{width:14,points:[[3,25],[5,23],[7,20],[9,16],[10,11],[10,7],[9,2],[7,-2],[5,-5],[3,-7]]},"*":{width:16,points:[[8,21],[8,9],null,[3,18],[13,12],null,[13,18],[3,12]]},"+":{width:26,points:[[13,18],[13,0],null,[4,9],[22,9]]},",":{width:10,points:[[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"-":{width:26,points:[[4,9],[22,9]]},".":{width:10,points:[[5,2],[4,1],[5,0],[6,1],[5,2]]},"/":{width:22,points:[[20,25],[2,-7]]},0:{width:20,points:[[9,21],[6,20],[4,17],[3,12],[3,9],[4,4],[6,1],[9,0],[11,0],[14,1],[16,4],[17,9],[17,12],[16,17],[14,20],[11,21],[9,21]]},1:{width:20,points:[[6,17],[8,18],[11,21],[11,0]]},2:{width:20,points:[[4,16],[4,17],[5,19],[6,20],[8,21],[12,21],[14,20],[15,19],[16,17],[16,15],[15,13],[13,10],[3,0],[17,0]]},3:{width:20,points:[[5,21],[16,21],[10,13],[13,13],[15,12],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},4:{width:20,points:[[13,21],[3,7],[18,7],null,[13,21],[13,0]]},5:{width:20,points:[[15,21],[5,21],[4,12],[5,13],[8,14],[11,14],[14,13],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},6:{width:20,points:[[16,18],[15,20],[12,21],[10,21],[7,20],[5,17],[4,12],[4,7],[5,3],[7,1],[10,0],[11,0],[14,1],[16,3],[17,6],[17,7],[16,10],[14,12],[11,13],[10,13],[7,12],[5,10],[4,7]]},7:{width:20,points:[[17,21],[7,0],null,[3,21],[17,21]]},8:{width:20,points:[[8,21],[5,20],[4,18],[4,16],[5,14],[7,13],[11,12],[14,11],[16,9],[17,7],[17,4],[16,2],[15,1],[12,0],[8,0],[5,1],[4,2],[3,4],[3,7],[4,9],[6,11],[9,12],[13,13],[15,14],[16,16],[16,18],[15,20],[12,21],[8,21]]},9:{width:20,points:[[16,14],[15,11],[13,9],[10,8],[9,8],[6,9],[4,11],[3,14],[3,15],[4,18],[6,20],[9,21],[10,21],[13,20],[15,18],[16,14],[16,9],[15,4],[13,1],[10,0],[8,0],[5,1],[4,3]]},":":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],null,[5,2],[4,1],[5,0],[6,1],[5,2]]},";":{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],null,[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},"<":{width:24,points:[[20,18],[4,9],[20,0]]},"=":{width:26,points:[[4,12],[22,12],null,[4,6],[22,6]]},">":{width:24,points:[[4,18],[20,9],[4,0]]},"?":{width:18,points:[[3,16],[3,17],[4,19],[5,20],[7,21],[11,21],[13,20],[14,19],[15,17],[15,15],[14,13],[13,12],[9,10],[9,7],null,[9,2],[8,1],[9,0],[10,1],[9,2]]},"@":{width:27,points:[[18,13],[17,15],[15,16],[12,16],[10,15],[9,14],[8,11],[8,8],[9,6],[11,5],[14,5],[16,6],[17,8],null,[12,16],[10,14],[9,11],[9,8],[10,6],[11,5],null,[18,16],[17,8],[17,6],[19,5],[21,5],[23,7],[24,10],[24,12],[23,15],[22,17],[20,19],[18,20],[15,21],[12,21],[9,20],[7,19],[5,17],[4,15],[3,12],[3,9],[4,6],[5,4],[7,2],[9,1],[12,0],[15,0],[18,1],[20,2],[21,3],null,[19,16],[18,8],[18,6],[19,5]]},A:{width:18,points:[[9,21],[1,0],null,[9,21],[17,0],null,[4,7],[14,7]]},B:{width:21,points:[[4,21],[4,0],null,[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],null,[4,11],[13,11],[16,10],[17,9],[18,7],[18,4],[17,2],[16,1],[13,0],[4,0]]},C:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5]]},D:{width:21,points:[[4,21],[4,0],null,[4,21],[11,21],[14,20],[16,18],[17,16],[18,13],[18,8],[17,5],[16,3],[14,1],[11,0],[4,0]]},E:{width:19,points:[[4,21],[4,0],null,[4,21],[17,21],null,[4,11],[12,11],null,[4,0],[17,0]]},F:{width:18,points:[[4,21],[4,0],null,[4,21],[17,21],null,[4,11],[12,11]]},G:{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[18,8],null,[13,8],[18,8]]},H:{width:22,points:[[4,21],[4,0],null,[18,21],[18,0],null,[4,11],[18,11]]},I:{width:8,points:[[4,21],[4,0]]},J:{width:16,points:[[12,21],[12,5],[11,2],[10,1],[8,0],[6,0],[4,1],[3,2],[2,5],[2,7]]},K:{width:21,points:[[4,21],[4,0],null,[18,21],[4,7],null,[9,12],[18,0]]},L:{width:17,points:[[4,21],[4,0],null,[4,0],[16,0]]},M:{width:24,points:[[4,21],[4,0],null,[4,21],[12,0],null,[20,21],[12,0],null,[20,21],[20,0]]},N:{width:22,points:[[4,21],[4,0],null,[4,21],[18,0],null,[18,21],[18,0]]},O:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21]]},P:{width:21,points:[[4,21],[4,0],null,[4,21],[13,21],[16,20],[17,19],[18,17],[18,14],[17,12],[16,11],[13,10],[4,10]]},Q:{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21],null,[12,4],[18,-2]]},R:{width:21,points:[[4,21],[4,0],null,[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[4,11],null,[11,11],[18,0]]},S:{width:20,points:[[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},T:{width:16,points:[[8,21],[8,0],null,[1,21],[15,21]]},U:{width:22,points:[[4,21],[4,6],[5,3],[7,1],[10,0],[12,0],[15,1],[17,3],[18,6],[18,21]]},V:{width:18,points:[[1,21],[9,0],null,[17,21],[9,0]]},W:{width:24,points:[[2,21],[7,0],null,[12,21],[7,0],null,[12,21],[17,0],null,[22,21],[17,0]]},X:{width:20,points:[[3,21],[17,0],null,[17,21],[3,0]]},Y:{width:18,points:[[1,21],[9,11],[9,0],null,[17,21],[9,11]]},Z:{width:20,points:[[17,21],[3,0],null,[3,21],[17,21],null,[3,0],[17,0]]},"[":{width:14,points:[[4,25],[4,-7],null,[5,25],[5,-7],null,[4,25],[11,25],null,[4,-7],[11,-7]]},"\\":{width:14,points:[[0,21],[14,-3]]},"]":{width:14,points:[[9,25],[9,-7],null,[10,25],[10,-7],null,[3,25],[10,25],null,[3,-7],[10,-7]]},"^":{width:14,points:[[3,10],[8,18],[13,10]]},_:{width:16,points:[[0,-2],[16,-2]]},"`":{width:10,points:[[6,21],[5,20],[4,18],[4,16],[5,15],[6,16],[5,17]]},a:{width:19,points:[[15,14],[15,0],null,[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},b:{width:19,points:[[4,21],[4,0],null,[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},c:{width:18,points:[[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},d:{width:19,points:[[15,21],[15,0],null,[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},e:{width:18,points:[[3,8],[15,8],[15,10],[14,12],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},f:{width:12,points:[[10,21],[8,21],[6,20],[5,17],[5,0],null,[2,14],[9,14]]},g:{width:19,points:[[15,14],[15,-2],[14,-5],[13,-6],[11,-7],[8,-7],[6,-6],null,[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},h:{width:19,points:[[4,21],[4,0],null,[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},i:{width:8,points:[[3,21],[4,20],[5,21],[4,22],[3,21],null,[4,14],[4,0]]},j:{width:10,points:[[5,21],[6,20],[7,21],[6,22],[5,21],null,[6,14],[6,-3],[5,-6],[3,-7],[1,-7]]},k:{width:17,points:[[4,21],[4,0],null,[14,14],[4,4],null,[8,8],[15,0]]},l:{width:8,points:[[4,21],[4,0]]},m:{width:30,points:[[4,14],[4,0],null,[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0],null,[15,10],[18,13],[20,14],[23,14],[25,13],[26,10],[26,0]]},n:{width:19,points:[[4,14],[4,0],null,[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},o:{width:19,points:[[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3],[16,6],[16,8],[15,11],[13,13],[11,14],[8,14]]},p:{width:19,points:[[4,14],[4,-7],null,[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},q:{width:19,points:[[15,14],[15,-7],null,[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},r:{width:13,points:[[4,14],[4,0],null,[4,8],[5,11],[7,13],[9,14],[12,14]]},s:{width:17,points:[[14,11],[13,13],[10,14],[7,14],[4,13],[3,11],[4,9],[6,8],[11,7],[13,6],[14,4],[14,3],[13,1],[10,0],[7,0],[4,1],[3,3]]},t:{width:12,points:[[5,21],[5,4],[6,1],[8,0],[10,0],null,[2,14],[9,14]]},u:{width:19,points:[[4,14],[4,4],[5,1],[7,0],[10,0],[12,1],[15,4],null,[15,14],[15,0]]},v:{width:16,points:[[2,14],[8,0],null,[14,14],[8,0]]},w:{width:22,points:[[3,14],[7,0],null,[11,14],[7,0],null,[11,14],[15,0],null,[19,14],[15,0]]},x:{width:17,points:[[3,14],[14,0],null,[14,14],[3,0]]},y:{width:16,points:[[2,14],[8,0],null,[14,14],[8,0],[6,-4],[4,-6],[2,-7],[1,-7]]},z:{width:17,points:[[14,14],[3,0],null,[3,14],[14,14],null,[3,0],[14,0]]},"{":{width:14,points:[[9,25],[7,24],[6,23],[5,21],[5,19],[6,17],[7,16],[8,14],[8,12],[6,10],null,[7,24],[6,22],[6,20],[7,18],[8,17],[9,15],[9,13],[8,11],[4,9],[8,7],[9,5],[9,3],[8,1],[7,0],[6,-2],[6,-4],[7,-6],null,[6,8],[8,6],[8,4],[7,2],[6,1],[5,-1],[5,-3],[6,-5],[7,-6],[9,-7]]},"|":{width:8,points:[[4,25],[4,-7]]},"}":{width:14,points:[[5,25],[7,24],[8,23],[9,21],[9,19],[8,17],[7,16],[6,14],[6,12],[8,10],null,[7,24],[8,22],[8,20],[7,18],[6,17],[5,15],[5,13],[6,11],[10,9],[6,7],[5,5],[5,3],[6,1],[7,0],[8,-2],[8,-4],[7,-6],null,[8,8],[6,6],[6,4],[7,2],[8,1],[9,-1],[9,-3],[8,-5],[7,-6],[5,-7]]},"~":{width:24,points:[[3,6],[3,8],[4,11],[6,12],[8,12],[10,11],[14,8],[16,7],[18,7],[20,8],[21,10],null,[3,8],[4,10],[6,11],[8,11],[10,10],[14,7],[16,6],[18,6],[20,7],[21,10],[21,12]]},"�":{diacritic:"`",letter:"a"},"�":{diacritic:"�",letter:"a"},"�":{diacritic:"^",letter:"a"},"�":{diacritic:"�",letter:"a"},"�":{diacritic:"~",letter:"a"},"�":{diacritic:"`",letter:"e"},"�":{diacritic:"�",letter:"e"},"�":{diacritic:"^",letter:"e"},"�":{diacritic:"�",letter:"e"},"�":{diacritic:"`",letter:"i"},"�":{diacritic:"�",letter:"i"},"�":{diacritic:"^",letter:"i"},"�":{diacritic:"�",letter:"i"},"�":{diacritic:"`",letter:"o"},"�":{diacritic:"�",letter:"o"},"�":{diacritic:"^",letter:"o"},"�":{diacritic:"�",letter:"o"},"�":{diacritic:"~",letter:"o"},"�":{diacritic:"`",letter:"u"},"�":{diacritic:"�",letter:"u"},"�":{diacritic:"^",letter:"u"},"�":{diacritic:"�",letter:"u"},"�":{diacritic:"�",letter:"y"},"�":{diacritic:"�",letter:"y"},"�":{diacritic:"�",letter:"c"},"�":{diacritic:"~",letter:"n"},"�":{diacritic:"`",letter:"A"},"�":{diacritic:"�",letter:"A"},"�":{diacritic:"^",letter:"A"},"�":{diacritic:"�",letter:"A"},"�":{diacritic:"~",letter:"A"},"�":{diacritic:"`",letter:"E"},"�":{diacritic:"�",letter:"E"},"�":{diacritic:"^",letter:"E"},"�":{diacritic:"�",letter:"E"},"�":{diacritic:"`",letter:"I"},"�":{diacritic:"�",letter:"I"},"�":{diacritic:"^",letter:"I"},"�":{diacritic:"�",letter:"I"},"�":{diacritic:"`",letter:"O"},"�":{diacritic:"�",letter:"O"},"�":{diacritic:"^",letter:"O"},"�":{diacritic:"�",letter:"O"},"�":{diacritic:"~",letter:"O"},"�":{diacritic:"`",letter:"U"},"�":{diacritic:"�",letter:"U"},"�":{diacritic:"^",letter:"U"},"�":{diacritic:"�",letter:"U"},"�":{diacritic:"�",letter:"Y"},"�":{diacritic:"�",letter:"C"},"�":{diacritic:"~",letter:"N"}},specialchars:{pi:{width:19,points:[[6,14],[6,0],null,[14,14],[14,0],null,[2,13],[6,16],[13,13],[17,16]]}},diacritics:{"�":{entity:"cedil",points:[[6,-4],[4,-6],[2,-7],[1,-7]]},"�":{entity:"acute",points:[[8,19],[13,22]]},"`":{entity:"grave",points:[[7,22],[12,19]]},"^":{entity:"circ",points:[[5.5,19],[9.5,23],[12.5,19]]},"�":{entity:"trema",points:[[5,21],[6,20],[7,21],[6,22],[5,21],null,[12,21],[13,20],[14,21],[13,22],[12,21]]},"~":{entity:"tilde",points:[[4,18],[7,22],[10,18],[13,22]]}},style:{size:8,font:null,color:"#000000",weight:1,textAlign:"left",textBaseline:"bottom",adjustAlign:!1,angle:0,tracking:1,boundingBoxColor:"#ff0000",originPointColor:"#000000"},debug:!1,_bufferLexemes:{},extend:function(a,b){for(var c in b){if(c in a)continue;a[c]=b[c]}return a},letter:function(a){return CanvasText.letters[a]},parseLexemes:function(a){if(CanvasText._bufferLexemes[a])return CanvasText._bufferLexemes[a];var b,c,d=a.match(/&[A-Za-z]{2,5};|\s|./g),e=[],f=[];for(b=0;b<d.length;b++){c=d[b];if(c.length==1)f.push(c);else{var g=c.substring(1,c.length-1);CanvasText.specialchars[g]?f.push(g):f=f.concat(c.toArray())}}for(b=0;b<f.length;b++)c=f[b],(c=CanvasText.letters[c]||CanvasText.specialchars[c])&&e.push(c);for(b=0;b<e.length;b++)(e===null||typeof e=="undefined")&&delete e[b];return CanvasText._bufferLexemes[a]=e},ascent:function(a){a=a||CanvasText.style;return a.size||CanvasText.style.size},descent:function(a){a=a||CanvasText.style;return 7*(a.size||CanvasText.style.size)/25},measure:function(a,b){if(!!a){b=b||CanvasText.style;var d,e,f=CanvasText.parseLexemes(a),g=0;for(d=f.length-1;d>-1;--d)c=f[d],e=c.diacritic?CanvasText.letter(c.letter).width:c.width,g+=e*(b.tracking||CanvasText.style.tracking)*(b.size||CanvasText.style.size)/25;return g}},getDimensions:function(a,b){b=b||CanvasText.style;var c=CanvasText.measure(a,b),d=b.size||CanvasText.style.size,e=b.angle||CanvasText.style.angle;return b.angle==0?{width:c,height:d}:{width:Math.abs(Math.cos(e)*c)+Math.abs(Math.sin(e)*d),height:Math.abs(Math.sin(e)*c)+Math.abs(Math.cos(e)*d)}},drawPoints:function(a,b,c,d,e,f){var g,h,i=!0,j=0;f=f||{x:0,y:0},a.beginPath();for(g=0;g<b.length;g++){h=b[g];if(!h){i=!0;continue}i?(a.moveTo(c+h[0]*e+f.x,d-h[1]*e+f.y),i=!1):a.lineTo(c+h[0]*e+f.x,d-h[1]*e+f.y)}a.stroke(),a.closePath()},draw:function(a,b,c,d){if(!!a){CanvasText.extend(d,CanvasText.style);var e,f,g=0,h=d.size/25,i=0,j=0,k=CanvasText.parseLexemes(a),l={x:0,y:0},m=CanvasText.measure(a,d),n;d.adjustAlign&&(n=CanvasText.getBestAlign(d.angle,d),CanvasText.extend(d,n));switch(d.textAlign){case"left":break;case"center":l.x=-m/2;break;case"right":l.x=-m}switch(d.textBaseline){case"bottom":break;case"middle":l.y=d.size/2;break;case"top":l.y=d.size}this.save(),this.translate(b,c),this.rotate(d.angle),this.lineCap="round",this.lineWidth=2*h*(d.weight||CanvasText.style.weight),this.strokeStyle=d.color||CanvasText.style.color;for(e=0;e<k.length;e++){f=k[e];if(f.width==-1){i=0,j=d.size*1.4;continue}var o=f.points,p=f.width;if(f.diacritic){var q=CanvasText.diacritics[f.diacritic],r=CanvasText.letter(f.letter);CanvasText.drawPoints(this,q.points,i,j-(f.letter.toUpperCase()==f.letter?3:0),h,l),o=r.points,p=r.width}CanvasText.drawPoints(this,o,i,j,h,l),CanvasText.debug&&(this.save(),this.lineJoin="miter",this.lineWidth=.5,this.strokeStyle=d.boundingBoxColor||CanvasText.style.boundingBoxColor,this.strokeRect(i+l.x,j+l.y,p*h,-d.size),this.fillStyle=d.originPointColor||CanvasText.style.originPointColor,this.beginPath(),this.arc(0,0,1.5,0,Math.PI*2,!0),this.fill(),this.closePath(),this.restore()),i+=p*h*(d.tracking||CanvasText.style.tracking)}this.restore();return g}}};CanvasText.proto=window.CanvasRenderingContext2D?window.CanvasRenderingContext2D.prototype:document.createElement("canvas").getContext("2d").__proto__,CanvasText.proto&&(CanvasText.proto.drawText=CanvasText.draw,CanvasText.proto.measure=CanvasText.measure,CanvasText.proto.getTextBounds=CanvasText.getDimensions,CanvasText.proto.fontAscent=CanvasText.ascent,CanvasText.proto.fontDescent=CanvasText.descent)/** 
 * @projectDescription Flotr is a javascript plotting library based on the Prototype Javascript Framework.
 * @author Bas Wenneker
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 * @version 0.2.0
 */
var Flotr={version:"0.2.0-alpha",revision:("$Revision: 192 $".match(/(\d+)/)||[null,null])[1],author:["Bas Wenneker","Fabien Ménager"],website:"http://www.solutoire.com",isIphone:/iphone/i.test(navigator.userAgent),isIE:navigator.appVersion.indexOf("MSIE")!=-1?parseFloat(navigator.appVersion.split("MSIE")[1]):!1,graphTypes:{},plugins:{},addType:function(a,b){Flotr.graphTypes[a]=b,Flotr.defaultOptions[a]=b.options||{},Flotr.defaultOptions.defaultType=Flotr.defaultOptions.defaultType||a},addPlugin:function(a,b){Flotr.plugins[a]=b,Flotr.defaultOptions[a]=b.options||{}},draw:function(a,b,c,d){d=d||Flotr.Graph;return new d(a,b,c)},getSeries:function(a){return _.map(a,function(a){a=a.data?_.clone(a):{data:a};for(var b=a.data.length-1;b>-1;--b)a.data[b][1]=a.data[b][1]===null?null:parseFloat(a.data[b][1]);return a})},merge:function(a,b){var c,d,e=b||{};for(c in a)d=a[c],e[c]=d&&typeof d=="object"&&d.constructor!==Array&&d.constructor!==RegExp&&!_.isElement(d)?Flotr.merge(d,b[c]):e[c]=d;return e},clone:function(a){var b,c,d={};for(b in a)c=a[b],d[b]=c&&typeof c=="object"&&c.constructor!==Array&&c.constructor!==RegExp&&!_.isElement(c)?Flotr.clone(c):c;return d},getTickSize:function(a,b,c,d){var e=(c-b)/a,f=Flotr.getMagnitude(e),g=10,h=e/f;h<1.5?g=1:h<2.25?g=2:h<3?g=d==0?2:2.5:h<7.5&&(g=5);return g*f},defaultTickFormatter:function(a){return a+""},defaultTrackFormatter:function(a){return"("+a.x+", "+a.y+")"},engineeringNotation:function(a,b,c){var d=["Y","Z","E","P","T","G","M","k",""],e=["y","z","a","f","p","n","µ","m",""],f=d.length;c=c||1e3,b=Math.pow(10,b||2);if(a==0)return 0;if(a>1)while(f--&&a>=c)a/=c;else{d=e,f=d.length;while(f--&&a<1)a*=c}return Math.round(a*b)/b+d[f]},getMagnitude:function(a){return Math.pow(10,Math.floor(Math.log(a)/Math.LN10))},toPixel:function(a){return Math.floor(a)+.5},toRad:function(a){return-a*(Math.PI/180)},floorInBase:function(a,b){return b*Math.floor(a/b)},drawText:function(a,b,c,d,e){!a.fillText||Flotr.isIphone?a.drawText(b,c,d,e):(e=_.extend({size:Flotr.defaultOptions.fontSize,color:"#000000",textAlign:"left",textBaseline:"bottom",weight:1,angle:0},e),a.save(),a.translate(c,d),a.rotate(e.angle),a.fillStyle=e.color,a.font=(e.weight>1?"bold ":"")+e.size*1.3+"px sans-serif",a.textAlign=e.textAlign,a.textBaseline=e.textBaseline,a.fillText(b,0,0),a.restore())},measureText:function(a,b,c){if(!a.fillText||Flotr.isIphone)return{width:a.measure(b,c)};c=_.extend({size:Flotr.defaultOptions.fontSize,weight:1,angle:0},c),a.save(),a.rotate(c.angle),a.font=(c.weight>1?"bold ":"")+c.size*1.3+"px sans-serif";var d=a.measureText(b);a.restore();return d},getBestTextAlign:function(a,b){b=b||{textAlign:"center",textBaseline:"middle"},a+=Flotr.getTextAngleFromAlign(b),Math.abs(Math.cos(a))>.01&&(b.textAlign=Math.cos(a)>0?"right":"left"),Math.abs(Math.sin(a))>.01&&(b.textBaseline=Math.sin(a)>0?"top":"bottom");return b},alignTable:{"right middle":0,"right top":Math.PI/4,"center top":Math.PI/2,"left top":3*(Math.PI/4),"left middle":Math.PI,"left bottom":-3*(Math.PI/4),"center bottom":-Math.PI/2,"right bottom":-Math.PI/4,"center middle":0},getTextAngleFromAlign:function(a){return Flotr.alignTable[a.textAlign+" "+a.textBaseline]||0}};Flotr.defaultOptions={colors:["#00A8F0","#C0D800","#CB4B4B","#4DA74D","#9440ED"],title:null,subtitle:null,shadowSize:4,defaultType:null,HtmlText:!0,fontSize:7.5,resolution:1,xaxis:{ticks:null,minorTicks:null,showLabels:!0,showMinorLabels:!1,labelsAngle:0,title:null,titleAngle:0,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:!1,autoscaleMargin:0,color:null,mode:"normal",timeFormat:null,scaling:"linear",base:Math.E,titleAlign:"center",margin:!0},x2axis:{},yaxis:{ticks:null,minorTicks:null,showLabels:!0,showMinorLabels:!1,labelsAngle:0,title:null,titleAngle:90,noTicks:5,minorTickFreq:null,tickFormatter:Flotr.defaultTickFormatter,tickDecimals:null,min:null,max:null,autoscale:!1,autoscaleMargin:0,color:null,scaling:"linear",base:Math.E,titleAlign:"center",margin:!0},y2axis:{titleAngle:270},grid:{color:"#545454",backgroundColor:null,backgroundImage:null,watermarkAlpha:.4,tickColor:"#DDDDDD",labelMargin:3,verticalLines:!0,minorVerticalLines:null,horizontalLines:!0,minorHorizontalLines:null,outlineWidth:2,circular:!1},selection:{mode:null,color:"#B6D9FF",fps:20},crosshair:{mode:null,color:"#FF0000",hideCursor:!0},mouse:{track:!1,trackAll:!1,position:"se",relative:!1,trackFormatter:Flotr.defaultTrackFormatter,margin:5,lineColor:"#FF3F19",trackDecimals:1,sensibility:2,trackY:!0,radius:3,fillColor:null,fillOpacity:.4}},Flotr.DOM={addClass:function(a,b){var c=a.className?a.className:"";_.include(c.split(/\s+/g),b)||(a.className=(c?c+" ":"")+b)},create:function(a){return document.createElement(a)},node:function(a){var b=Flotr.DOM.create("div"),c;b.innerHTML=a,c=b.children[0],b.innerHTML="";return c},empty:function(a){a.innerHTML=""},hide:function(a){Flotr.DOM.setStyles(a,{display:"none"})},insert:function(a,b){_.isString(b)?a.innerHTML+=b:_.isElement(b)&&a.appendChild(b)},opacity:function(a,b){a.style.opacity=b},position:function(a,b){if(!a.offsetParent)return{left:a.offsetLeft||0,top:a.offsetTop||0};b=this.position(a.offsetParent),b.left+=a.offsetLeft,b.top+=a.offsetTop;return b},removeClass:function(a,b){var c=a.className?a.className:"";a.className=_.filter(c.split(/\s+/g),function(a){if(a!=b)return!0}).join(" ")},setStyles:function(a,b){_.each(b,function(b,c){a.style[c]=b})},show:function(a){Flotr.DOM.setStyles(a,{display:""})},size:function(a){return{height:a.scrollHeight,width:a.scrollWidth}}},Flotr.EventAdapter={observe:function(a,b,c){bean.add(a,b,c);return this},fire:function(a,b,c){bean.fire(a,b,c),typeof Prototype!="undefined"&&Event.fire(a,b,c);return this},stopObserving:function(a,b,c){bean.remove(a,b,c);return this}},function(){Flotr.Color=function(a,b,c,d){this.rgba=["r","g","b","a"];var e=4;while(-1<--e)this[this.rgba[e]]=arguments[e]||(e==3?1:0);this.normalize()};var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]};Flotr.Color.prototype={adjust:function(a,b,c,d){var e=4;while(-1<--e)arguments[e]!=null&&(this[this.rgba[e]]+=arguments[e]);return this.normalize()},scale:function(a,b,c,d){var e=4;while(-1<--e)arguments[e]!=null&&(this[this.rgba[e]]*=arguments[e]);return this.normalize()},clone:function(){return new Flotr.Color(this.r,this.b,this.g,this.a)},limit:function(a,b,c){return Math.max(Math.min(a,c),b)},normalize:function(){var a=this.limit;this.r=a(parseInt(this.r),0,255),this.g=a(parseInt(this.g),0,255),this.b=a(parseInt(this.b),0,255),this.a=a(this.a,0,1);return this},distance:function(a){if(!!a){a=new Flotr.Color.parse(a);var b=0,c=3;while(-1<--c)b+=Math.abs(this[this.rgba[c]]-a[this.rgba[c]]);return b}},toString:function(){return this.a>=1?"rgb("+[this.r,this.g,this.b].join(",")+")":"rgba("+[this.r,this.g,this.b,this.a].join(",")+")"}},_.extend(Flotr.Color,{parse:function(b){if(b instanceof Flotr.Color)return b;var c,d=Flotr.Color;if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))return new d(parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16));if(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))return new d(parseInt(c[1]),parseInt(c[2]),parseInt(c[3]));if(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))return new d(parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16));if(c=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(b))return new d(parseInt(c[1]),parseInt(c[2]),parseInt(c[3]),parseFloat(c[4]));if(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))return new d(parseFloat(c[1])*2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55);if(c=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(b))return new d(parseFloat(c[1])*2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55,parseFloat(c[4]));var e=(b+"").replace(/^\s*([\S\s]*?)\s*$/,"$1").toLowerCase();return e=="transparent"?new d(255,255,255,0):(c=a[e])?new d(c[0],c[1],c[2]):new d(0,0,0,0)},processColor:function(a,b){if(!a)return"rgba(0, 0, 0, 0)";if(a instanceof Flotr.Color)return a.adjust(null,null,null,b.opacity).toString();if(_.isString(a))return Flotr.Color.parse(a).scale(null,null,null,b.opacity).toString();var c=a.colors?a:{colors:a};if(!b.ctx)return _.isArray(c.colors)?Flotr.Color.parse(_.isArray(c.colors[0])?c.colors[0][1]:c.colors[0]).scale(null,null,null,b.opacity).toString():"rgba(0, 0, 0, 0)";c=_.extend({start:"top",end:"bottom"},c),/top/i.test(c.start)&&(b.x1=0),/left/i.test(c.start)&&(b.y1=0),/bottom/i.test(c.end)&&(b.x2=0),/right/i.test(c.end)&&(b.y2=0);var d,e,f,g=b.ctx.createLinearGradient(b.x1,b.y1,b.x2,b.y2);for(d=0;d<c.colors.length;d++)e=c.colors[d],_.isArray(e)?(f=e[0],e=e[1]):f=d/(c.colors.length-1),g.addColorStop(f,Flotr.Color.parse(e).scale(null,null,null,b.opacity));return g},extract:function(a){var b;do{b=a.getStyle("background-color").toLowerCase();if(b!=""&&b!="transparent")break;a=a.up()}while(!a.nodeName.match(/^body$/i));return new Flotr.Color(b=="rgba(0, 0, 0, 0)"?"transparent":b)}})}(),Flotr.Date={format:function(a,b){function d(a){a+="";return a.length==1?"0"+a:a}if(!!a){var c={h:a.getUTCHours().toString(),H:d(a.getUTCHours()),M:d(a.getUTCMinutes()),S:d(a.getUTCSeconds()),s:a.getUTCMilliseconds(),d:a.getUTCDate().toString(),m:(a.getUTCMonth()+1).toString(),y:a.getUTCFullYear().toString(),b:Flotr.Date.monthNames[a.getUTCMonth()]},e=[],f,g=!1;for(var h=0;h<b.length;++h)f=b.charAt(h),g?(e.push(c[f]||f),g=!1):f=="%"?g=!0:e.push(f);return e.join("")}},getFormat:function(a,b){var c=Flotr.Date.timeUnits;return a<c.second?"%h:%M:%S.%s":a<c.minute?"%h:%M:%S":a<c.day?b<2*c.day?"%h:%M":"%b %d %h:%M":a<c.month?"%b %d":a<c.year?b<c.year?"%b":"%b %y":"%y"},formatter:function(a,b){var c=new Date(a);if(b.options.timeFormat!=null)return Flotr.Date.format(c,b.options.timeFormat);var d=b.max-b.min,e=b.tickSize*Flotr.Date.timeUnits[b.tickUnit];return Flotr.Date.format(c,Flotr.Date.getFormat(e,d))},generator:function(a){var b=[],c=new Date(a.min),d=Flotr.Date.timeUnits,e=a.tickSize*d[a.tickUnit];switch(a.tickUnit){case"millisecond":c.setUTCMilliseconds(Flotr.floorInBase(c.getUTCMilliseconds(),a.tickSize));break;case"second":c.setUTCSeconds(Flotr.floorInBase(c.getUTCSeconds(),a.tickSize));break;case"minute":c.setUTCMinutes(Flotr.floorInBase(c.getUTCMinutes(),a.tickSize));break;case"hour":c.setUTCHours(Flotr.floorInBase(c.getUTCHours(),a.tickSize));break;case"month":c.setUTCMonth(Flotr.floorInBase(c.getUTCMonth(),a.tickSize));break;case"year":c.setUTCFullYear(Flotr.floorInBase(c.getUTCFullYear(),a.tickSize))}e>=d.second&&c.setUTCMilliseconds(0),e>=d.minute&&c.setUTCSeconds(0),e>=d.hour&&c.setUTCMinutes(0),e>=d.day&&c.setUTCHours(0),e>=d.day*4&&c.setUTCDate(1),e>=d.year&&c.setUTCMonth(0);var f=0,g=Number.NaN,h;do{h=g,g=c.getTime(),b.push({v:g,label:Flotr.Date.formatter(g,a)});if(a.tickUnit=="month")if(a.tickSize<1){c.setUTCDate(1);var i=c.getTime();c.setUTCMonth(c.getUTCMonth()+1);var j=c.getTime();c.setTime(g+f*d.hour+(j-i)*a.tickSize),f=c.getUTCHours(),c.setUTCHours(0)}else c.setUTCMonth(c.getUTCMonth()+a.tickSize);else a.tickUnit=="year"?c.setUTCFullYear(c.getUTCFullYear()+a.tickSize):c.setTime(g+e)}while(g<a.max&&g!=h);return b},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:31556952e3},spec:[[1,"millisecond"],[20,"millisecond"],[50,"millisecond"],[100,"millisecond"],[200,"millisecond"],[500,"millisecond"],[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},function(){function b(a){return Flotr.isIE&&Flotr.isIE<9?{x:a.clientX+document.body.scrollLeft,y:a.clientY+document.body.scrollTop}:{x:a.pageX,y:a.pageY}}var a=Flotr.DOM;Flotr.Graph=function(a,b,c){try{this.el=a;if(!this.el)throw"The target container doesn't exist";if(!this.el.clientWidth)throw"The target container must be visible";this.registerPlugins(),Flotr.EventAdapter.fire(this.el,"flotr:beforeinit",[this]),this.el.graph=this,this.data=b,this.lastMousePos={pageX:null,pageY:null},this.selection={first:{x:-1,y:-1},second:{x:-1,y:-1}},this.plotOffset={left:0,right:0,top:0,bottom:0},this.prevSelection=null,this.selectionInterval=null,this.ignoreClick=!1,this.prevHit=null,this.series=Flotr.getSeries(b),this.setOptions(c);var d,e;for(d in Flotr.graphTypes){this[d]=_.clone(Flotr.graphTypes[d]);for(e in this[d])_.isFunction(this[d][e])&&(this[d][e]=_.bind(this[d][e],this))}this.constructCanvas(),Flotr.EventAdapter.fire(this.el,"flotr:afterconstruct",[this]),this.initEvents(),this.findDataRanges(),this.calculateTicks(this.axes.x),this.calculateTicks(this.axes.x2),this.calculateTicks(this.axes.y),this.calculateTicks(this.axes.y2),this.calculateSpacing(),this.setupAxes(),this.draw(_.bind(function(){Flotr.EventAdapter.fire(this.el,"flotr:afterinit",[this])},this))}catch(f){try{console.error(f)}catch(g){}}},Flotr.Graph.prototype={setOptions:function(a){var b=Flotr.clone(Flotr.defaultOptions);b.x2axis=_.extend(_.clone(b.xaxis),b.x2axis),b.y2axis=_.extend(_.clone(b.yaxis),b.y2axis),this.options=Flotr.merge(a||{},b),this.axes={x:{options:this.options.xaxis,n:1},x2:{options:this.options.x2axis,n:2},y:{options:this.options.yaxis,n:1},y2:{options:this.options.y2axis,n:2}},this.options.grid.minorVerticalLines===null&&this.options.xaxis.scaling==="logarithmic"&&(this.options.grid.minorVerticalLines=!0),this.options.grid.minorHorizontalLines===null&&this.options.yaxis.scaling==="logarithmic"&&(this.options.grid.minorHorizontalLines=!0);var c=[],d=[],e=this.series.length,f=this.series.length,g=this.options.colors,h=[],i=0,j,k,l,m;for(k=f-1;k>-1;--k)j=this.series[k].color,j&&(--f,_.isNumber(j)?c.push(j):h.push(Flotr.Color.parse(j)));for(k=c.length-1;k>-1;--k)f=Math.max(f,c[k]+1);for(k=0;d.length<f;){j=g.length==k?new Flotr.Color(100,100,100):Flotr.Color.parse(g[k]);var n=i%2==1?-1:1,o=1+n*Math.ceil(i/2)*.2;j.scale(o,o,o),d.push(j),++k>=g.length&&(k=0,++i)}for(k=0,l=0;k<e;++k){m=this.series[k],m.color==null?m.color=d[l++].toString():_.isNumber(m.color)&&(m.color=d[m.color].toString()),m.xaxis||(m.xaxis=this.axes.x),m.xaxis==1?m.xaxis=this.axes.x:m.xaxis==2&&(m.xaxis=this.axes.x2),m.yaxis||(m.yaxis=this.axes.y),m.yaxis==1?m.yaxis=this.axes.y:m.yaxis==2&&(m.yaxis=this.axes.y2);for(var p in Flotr.graphTypes)m[p]=_.extend(_.clone(this.options[p]),m[p]);m.mouse=_.extend(_.clone(this.options.mouse),m.mouse),m.shadowSize==null&&(m.shadowSize=this.options.shadowSize)}},getType:function(a){var b=a&&a.type?a.type:this.options.defaultType;return this[b]},executeOnType:function(a,b,c){function e(a){_.each(_.keys(Flotr.graphTypes),function(e){if(a[e]&&a[e].show)try{_.isUndefined(c)?this[e][b].apply(this[e]):this[e][b].apply(this[e],c),d=!0}catch(f){}},this)}var d=!1;_.isArray(a)||(a=[a]),_.each(a,e,this);return d},setupAxes:function(){function b(a,b){b.scaling==="logarithmic"&&(a=b.base===Math.E?Math.exp(a):Math.pow(b.base,a));return a}function a(a,b){b.scaling==="logarithmic"&&(a=Math.log(Math.max(a,Number.MIN_VALUE)),b.base!==Math.E&&(a/=Math.log(b.base)));return a}var c=this.axes.x,d=this.axes.x2,e=this.axes.y,f=this.axes.y2,g=this.plotWidth,h=this.plotHeight;c.scale=g/(a(c.max,c.options)-a(c.min,c.options)),d.scale=g/(a(d.max,d.options)-a(d.min,d.options)),e.scale=h/(a(e.max,e.options)-a(e.min,e.options)),f.scale=h/(a(f.max,f.options)-a(f.min,f.options)),this.options.scaling==="logarithmic"?(c.d2p=d.d2p=function(b){var c=this.options;return(a(b,c)-a(this.min,c))*this.scale},c.p2d=this.axes.x2.p2d=function(c){var d=this.options;return b(c/this.scale+a(this.min,d),d)},e.d2p=f.d2p=function(b){var c=this.options;return h-(a(b,c)-a(this.min,c))*this.scale},e.p2d=f.p2d=function(c){var d=this.options;return b((h-c)/this.scale+a(this.min,d),d)}):(c.d2p=d.d2p=function(a){return(a-this.min)*this.scale},c.p2d=this.axes.x2.p2d=function(a){return a/this.scale+this.min},e.d2p=f.d2p=function(a){return h-(a-this.min)*this.scale},e.p2d=f.p2d=function(a){return(h-a)/this.scale+this.min})},constructCanvas:function(){function g(a){window.G_vmlCanvasManager&&window.G_vmlCanvasManager.initElement(a);var b=a.getContext("2d");window.G_vmlCanvasManager||b.scale(c.resolution,c.resolution);return b}function f(e,f){e||(e=a.create("canvas"),e.className="flotr-"+f,e.style.cssText="position:absolute;left:0px;top:0px;"),_.each(d,function(b,d){e.setAttribute(d,b*c.resolution),e.style[d]=b+"px",a.show(e)}),e.context_=null,a.insert(b,e);return e}var b=this.el,c=this.options,d,e;a.empty(b),a.setStyles(b,{position:"relative",cursor:b.style.cursor||"default"}),d=a.size(b);if(d.width<=0||d.height<=0||c.resolution<=0)throw"Invalid dimensions for plot, width = "+d.width+", height = "+d.height+", resolution = "+c.resolution;this.canvas=f(this.canvas,"canvas"),this.overlay=f(this.overlay,"overlay"),this.ctx=g(this.canvas),this.octx=g(this.overlay),this.canvasHeight=d.height*c.resolution,this.canvasWidth=d.width*c.resolution,this.textEnabled=!!this.ctx.drawText},processColor:function(a,b){var c={x1:0,y1:0,x2:this.plotWidth,y2:this.plotHeight,opacity:1,ctx:this.ctx};_.extend(c,b);return Flotr.Color.processColor(a,c)},registerPlugins:function(){var a,b,c;for(a in Flotr.plugins){b=Flotr.plugins[a];for(c in b.callbacks)Flotr.EventAdapter.stopObserving(this.el,c).observe(this.el,c,_.bind(b.callbacks[c],this));this[a]=_.clone(b);for(p in this[a])_.isFunction(this[a][p])&&(this[a][p]=_.bind(this[a][p],this))}},getTextDimensions:function(b,c,d,e){if(!b)return{width:0,height:0};if(!this.options.HtmlText&&this.textEnabled){var f=this.ctx.getTextBounds(b,c);return{width:f.width+2,height:f.height+6}}var g=a.create("div");a.setStyles(g,{position:"absolute",top:"-10000px"}),a.insert(g,'<div style="'+d+'" class="'+e+' flotr-dummy-div">'+b+"</div>"),a.insert(this.el,g);return a.size(g)},initEvents:function(){Flotr.EventAdapter.stopObserving(this.overlay).observe(this.overlay,"mousedown",_.bind(this.mouseDownHandler,this)).observe(this.overlay,"mousemove",_.bind(this.mouseMoveHandler,this)).observe(this.overlay,"mouseout",_.bind(this.clearHit,this)).observe(this.overlay,"click",_.bind(this.clickHandler,this))},findDataRanges:function(){var a=this.series,b=this.axes;b.x.datamin=b.x2.datamin=b.y.datamin=b.y2.datamin=Number.MAX_VALUE,b.x.datamax=b.x2.datamax=b.y.datamax=b.y2.datamax=-Number.MAX_VALUE;if(a.length>0){var c,d,e,f,g,h,i,j;for(c=0;c<a.length;++c){h=a[c].data,i=a[c].xaxis,j=a[c].yaxis;if(h.length>0&&!a[c].hide)for(e=h.length-1;e>-1;--e){f=h[e][0];if(f<=0&&i.options.scaling==="logarithmic")continue;f<i.datamin&&(i.datamin=f,i.used=!0),f>i.datamax&&(i.datamax=f,i.used=!0);for(d=1;d<h[e].length;d++){g=h[e][d];if(g<=0&&j.options.scaling==="logarithmic")continue;g<j.datamin&&(j.datamin=g,j.used=!0),g>j.datamax&&(j.datamax=g,j.used=!0)}}}}this.findAxesValues(),this.calculateRange(b.x,"x"),b.x2.used&&this.calculateRange(b.x2,"x"),this.calculateRange(b.y,"y"),b.y2.used&&this.calculateRange(b.y2,"y")},extendRange:function(a,b){var c=b==="y"?"extendYRange":"extendXRange";for(var d in Flotr.graphTypes)if(this.options[d]&&this.options[d].show)this[d][c]&&this[d][c](a);else{var e=!1;for(i=0;i<this.series.length;i++){var f=this.series[i];if(f[d]&&f[d].show){e=!0;break}}e&&this[d][c]&&this[d][c](a)}},calculateRange:function(a,b){var c=a.options,d=c.min!=null?c.min:a.datamin,e=c.max!=null?c.max:a.datamax,f=c.autoscaleMargin;c.scaling=="logarithmic"&&(d<=0&&(d=a.datamin),e<=0&&(e=d));if(e-d==0){var g=e==0?1:.01;d-=g,e+=g}if(c.scaling==="logarithmic"){d<0&&(d=e/c.base);var h=Math.log(e);c.base!=Math.E&&(h/=Math.log(c.base)),h=Math.ceil(h);var i=Math.log(d);c.base!=Math.E&&(i/=Math.log(c.base)),i=Math.ceil(i),a.tickSize=Flotr.getTickSize(c.noTicks,i,h,c.tickDecimals===null?0:c.tickDecimals),c.minorTickFreq===null&&(h-i>10?c.minorTickFreq=0:h-i>5?c.minorTickFreq=2:c.minorTickFreq=5)}else a.tickSize=Flotr.getTickSize(c.noTicks,d,e,c.tickDecimals);a.min=d,a.max=e,this.extendRange(a,b),c.min==null&&c.autoscale&&(a.min-=a.tickSize*f,a.min<0&&a.datamin>=0&&(a.min=0),a.min=a.tickSize*Math.floor(a.min/a.tickSize)),c.max==null&&c.autoscale&&(a.max+=a.tickSize*f,a.max>0&&a.datamax<=0&&a.datamax!=a.datamin&&(a.max=0),a.max=a.tickSize*Math.ceil(a.max/a.tickSize)),a.min==a.max&&(a.max=a.min+1)},findAxesValues:function(){var a,b,c;for(a=this.series.length-1;a>-1;--a)c=this.series[a],this.executeOnType(this.series,"findAxesValues",[c])||this.findXAxesValues(c)},findXAxesValues:function(a){var b;a.xaxis.values=a.xaxis.values||{};for(b=a.data.length-1;b>-1;--b)a.xaxis.values[a.data[b][0]+""]={}},findYAxesValues:function(a){var b;a.yaxis.values=a.yaxis.values||{};for(b=a.data.length-1;b>-1;--b)a.yaxis.values[a.data[b][1]+""]={}},calculateTicks:function(a){var b=a.options,c,d;a.ticks=[],a.minorTicks=[];if(b.ticks){var e=b.ticks,f=b.minorTicks||[],g,h;_.isFunction(e)&&(e=e({min:a.min,max:a.max})),_.isFunction(f)&&(f=f({min:a.min,max:a.max}));for(c=0;c<e.length;++c)g=e[c],typeof g=="object"?(d=g[0],h=g.length>1?g[1]:b.tickFormatter(d)):(d=g,h=b.tickFormatter(d)),a.ticks[c]={v:d,label:h};for(c=0;c<f.length;++c)g=f[c],typeof g=="object"?(d=g[0],h=g.length>1?g[1]:b.tickFormatter(d)):(d=g,h=b.tickFormatter(d)),a.minorTicks[c]={v:d,label:h}}else if(b.mode=="time"){var i=Flotr.Date.timeUnits,j=Flotr.Date.spec,k=(a.max-a.min)/a.options.noTicks,l,m;for(c=0;c<j.length-1;++c){var n=j[c][0]*i[j[c][1]];if(k<(n+j[c+1][0]*i[j[c+1][1]])/2&&n>=a.tickSize)break}l=j[c][0],m=j[c][1],m=="year"&&(l=Flotr.getTickSize(a.options.noTicks*i.year,a.min,a.max,0)),a.tickSize=l,a.tickUnit=m,a.ticks=Flotr.Date.generator(a)}else if(b.scaling==="logarithmic"){var o=Math.log(a.max);b.base!=Math.E&&(o/=Math.log(b.base)),o=Math.ceil(o);var p=Math.log(a.min);b.base!=Math.E&&(p/=Math.log(b.base)),p=Math.ceil(p);for(c=p;c<o;c+=a.tickSize){var q=b.base==Math.E?Math.exp(c):Math.pow(b.base,c),r=q*(b.base==Math.E?Math.exp(a.tickSize):Math.pow(b.base,a.tickSize)),s=(r-q)/b.minorTickFreq;a.ticks.push({v:q,label:b.tickFormatter(q)});for(d=q+s;d<r;d+=s)a.minorTicks.push({v:d,label:b.tickFormatter(d)})}var q=b.base==Math.E?Math.exp(c):Math.pow(b.base,c);a.ticks.push({v:q,label:b.tickFormatter(q)})}else{var t=a.tickSize*Math.ceil(a.min/a.tickSize),u,v,w;b.minorTickFreq&&(v=a.tickSize/b.minorTickFreq);for(c=0;t+c*a.tickSize<=a.max;++c){d=w=t+c*a.tickSize,u=b.tickDecimals,u==null&&(u=1-Math.floor(Math.log(a.tickSize)/Math.LN10)),u<0&&(u=0),d=d.toFixed(u),a.ticks.push({v:d,label:b.tickFormatter(d)});if(b.minorTickFreq)for(var x=0;x<b.minorTickFreq&&c*a.tickSize+x*v<a.max;++x)d=w+x*v,d=d.toFixed(u),a.minorTicks.push({v:d,label:b.tickFormatter(d)})}}},calculateSpacing:function(){var a=this.axes,b=this.options,c=this.series,d=b.grid.labelMargin,e=a.x,f=a.x2,g=a.y,h=a.y2,i=2,j,k,l,m;_.each([e,f,g,h],function(a){var c="";if(a.options.showLabels)for(j=0;j<a.ticks.length;++j)l=a.ticks[j].label.length,l>c.length&&(c=a.ticks[j].label);a.maxLabel=this.getTextDimensions(c,{size:b.fontSize,angle:Flotr.toRad(a.options.labelsAngle)},"font-size:smaller;","flotr-grid-label"),a.titleSize=this.getTextDimensions(a.options.title,{size:b.fontSize*1.2,angle:Flotr.toRad(a.options.titleAngle)},"font-weight:bold;","flotr-axis-title")},this),m=this.getTextDimensions(b.title,{size:b.fontSize*1.5},"font-size:1em;font-weight:bold;","flotr-title"),this.titleHeight=m.height,m=this.getTextDimensions(b.subtitle,{size:b.fontSize},"font-size:smaller;","flotr-subtitle"),this.subtitleHeight=m.height,b.show&&(i=Math.max(i,b.points.radius+b.points.lineWidth/2));for(k=0;k<b.length;++k)c[k].points.show&&(i=Math.max(i,c[k].points.radius+c[k].points.lineWidth/2));var n=this.plotOffset;e.options.margin===!1?(n.bottom=0,n.top=0):(n.bottom+=(b.grid.circular?0:e.options.showLabels?e.maxLabel.height+d:0)+(e.options.title?e.titleSize.height+d:0)+i,n.top+=(b.grid.circular?0:f.options.showLabels?f.maxLabel.height+d:0)+(f.options.title?f.titleSize.height+d:0)+this.subtitleHeight+this.titleHeight+i),g.options.margin===!1?(n.left=0,n.right=0):(n.left+=(b.grid.circular?0:g.options.showLabels?g.maxLabel.width+d:0)+(g.options.title?g.titleSize.width+d:0)+i,n.right+=(b.grid.circular?0:h.options.showLabels?h.maxLabel.width+d:0)+(h.options.title?h.titleSize.width+d:0)+i),n.top=Math.floor(n.top),this.plotWidth=this.canvasWidth-n.left-n.right,this.plotHeight=this.canvasHeight-n.bottom-n.top},draw:function(a){var b=_.bind(function(){this.drawGrid(),this.drawLabels(),this.drawTitles();if(this.series.length){Flotr.EventAdapter.fire(this.el,"flotr:beforedraw",[this.series,this]);for(var b=0;b<this.series.length;b++)this.series[b].hide||this.drawSeries(this.series[b])}this.drawOutline(),Flotr.EventAdapter.fire(this.el,"flotr:afterdraw",[this.series,this]),a()},this),c=this.options.grid;if(c&&c.backgroundImage){_.isString(c.backgroundImage)?c.backgroundImage={src:c.backgroundImage,left:0,top:0}:c.backgroundImage=_.extend({left:0,top:0},c.backgroundImage);var d=new Image;d.onload=_.bind(function(){var a=this.plotOffset.left+(parseInt(c.backgroundImage.left)||0),e=this.plotOffset.top+(parseInt(c.backgroundImage.top)||0),f=this.ctx.globalAlpha;this.ctx.globalAlpha=c.backgroundImage.alpha||f,this.ctx.drawImage(d,a,e),this.ctx.globalAlpha=f,b()},this),d.onabort=d.onerror=b,d.src=c.backgroundImage.src}else b()},drawGrid:function(){var a,b=this.options,c=this.ctx,d;(b.grid.verticalLines||b.grid.minorVerticalLines||b.grid.horizontalLines||b.grid.minorHorizontalLines)&&Flotr.EventAdapter.fire(this.el,"flotr:beforegrid",[this.axes.x,this.axes.y,b,this]),c.save(),c.lineWidth=1,c.strokeStyle=b.grid.tickColor;if(b.grid.circular){c.translate(this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+this.plotHeight/2);var e=Math.min(this.plotHeight,this.plotWidth)*b.radar.radiusRatio/2,f=this.axes.x.ticks.length,g=2*(Math.PI/f),h=-Math.PI/2;c.beginPath();if(b.grid.horizontalLines){d=this.axes.y;for(var i=0;i<d.ticks.length;++i){a=d.ticks[i].v;var j=a/d.max;for(var k=0;k<=f;++k)c[k==0?"moveTo":"lineTo"](Math.cos(k*g+h)*e*j,Math.sin(k*g+h)*e*j)}}if(b.grid.minorHorizontalLines){d=this.axes.y;for(var i=0;i<d.minorTicks.length;++i){a=d.minorTicks[i].v;var j=a/d.max;for(var k=0;k<=f;++k)c[k==0?"moveTo":"lineTo"](Math.cos(k*g+h)*e*j,Math.sin(k*g+h)*e*j)}}if(b.grid.verticalLines)for(var i=0;i<f;++i)c.moveTo(0,0),c.lineTo(Math.cos(i*g+h)*e,Math.sin(i*g+h)*e);c.stroke()}else{c.translate(this.plotOffset.left,this.plotOffset.top),b.grid.backgroundColor!=null&&(c.fillStyle=this.processColor(b.grid.backgroundColor,{x1:0,y1:0,x2:this.plotWidth,y2:this.plotHeight}),c.fillRect(0,0,this.plotWidth,this.plotHeight)),c.beginPath();if(b.grid.verticalLines){d=this.axes.x;for(var i=0;i<d.ticks.length;++i){a=d.ticks[i].v;if(a<=d.min||a>=d.max||(a==d.min||a==d.max)&&b.grid.outlineWidth!=0)continue;c.moveTo(Math.floor(d.d2p(a))+c.lineWidth/2,0),c.lineTo(Math.floor(d.d2p(a))+c.lineWidth/2,this.plotHeight)}}if(b.grid.minorVerticalLines){d=this.axes.x;for(var i=0;i<d.minorTicks.length;++i){a=d.minorTicks[i].v;if(a<=d.min||a>=d.max||(a==d.min||a==d.max)&&b.grid.outlineWidth!=0)continue;c.moveTo(Math.floor(d.d2p(a))+c.lineWidth/2,0),c.lineTo(Math.floor(d.d2p(a))+c.lineWidth/2,this.plotHeight)}}if(b.grid.horizontalLines){d=this.axes.y;for(var k=0;k<d.ticks.length;++k){a=d.ticks[k].v;if(a<=d.min||a>=d.max||(a==d.min||a==d.max)&&b.grid.outlineWidth!=0)continue;c.moveTo(0,Math.floor(d.d2p(a))+c.lineWidth/2),c.lineTo(this.plotWidth,Math.floor(d.d2p(a))+c.lineWidth/2)}}if(b.grid.minorHorizontalLines){d=this.axes.y;for(var k=0;k<d.minorTicks.length;++k){a=d.minorTicks[k].v;if(a<=d.min||a>=d.max||(a==d.min||a==d.max)&&b.grid.outlineWidth!=0)continue;c.moveTo(0,Math.floor(d.d2p(a))+c.lineWidth/2),c.lineTo(this.plotWidth,Math.floor(d.d2p(a))+c.lineWidth/2)}}c.stroke()}c.restore(),(b.grid.verticalLines||b.grid.minorVerticalLines||b.grid.horizontalLines||b.grid.minorHorizontalLines)&&Flotr.EventAdapter.fire(this.el,"flotr:aftergrid",[this.axes.x,this.axes.y,b,this])},drawOutline:function(){var a,b=this.options,c=this.ctx;if(b.grid.outlineWidth!=0){c.save();if(b.grid.circular){c.translate(this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+this.plotHeight/2);var d=Math.min(this.plotHeight,this.plotWidth)*b.radar.radiusRatio/2,e=this.axes.x.ticks.length,f=2*(Math.PI/e),g=-Math.PI/2;c.beginPath(),c.lineWidth=b.grid.outlineWidth,c.strokeStyle=b.grid.color,c.lineJoin="round";for(var h=0;h<=e;++h)c[h==0?"moveTo":"lineTo"](Math.cos(h*f+g)*d,Math.sin(h*f+g)*d);c.stroke()}else{c.translate(this.plotOffset.left,this.plotOffset.top);var i=b.grid.outlineWidth,j=.5-i+(i+1)%2/2;c.lineWidth=i,c.strokeStyle=b.grid.color,c.lineJoin="miter",c.strokeRect(j,j,this.plotWidth,this.plotHeight)}c.restore()}},drawLabels:function(){var b=0,c,d,e,f,g,h,i,j=this.options,k=this.ctx,l=this.axes;for(e=0;e<l.x.ticks.length;++e)l.x.ticks[e].label&&++b;d=this.plotWidth/b;if(j.grid.circular){k.save(),k.translate(this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+this.plotHeight/2);var m=this.plotHeight*j.radar.radiusRatio/2+j.fontSize,n=this.axes.x.ticks.length,o=2*(Math.PI/n),p=-Math.PI/2,q={size:j.fontSize};c=l.x,q.color=c.options.color||j.grid.color;for(e=0;e<c.ticks.length&&c.options.showLabels;++e){g=c.ticks[e],g.label+="";if(!g.label||g.label.length==0)continue;var r=Math.cos(e*o+p)*m,s=Math.sin(e*o+p)*m;q.angle=Flotr.toRad(c.options.labelsAngle),q.textBaseline="middle",q.textAlign=Math.abs(r)<.1?"center":r<0?"right":"left",Flotr.drawText(k,g.label,r,s,q)}for(e=0;e<c.minorTicks.length&&c.options.showMinorLabels;++e){g=c.minorTicks[e],g.label+="";if(!g.label||g.label.length==0)continue;var r=Math.cos(e*o+p)*m,s=Math.sin(e*o+p)*m;q.angle=Flotr.toRad(c.options.labelsAngle),q.textBaseline="middle",q.textAlign=Math.abs(r)<.1?"center":r<0?"right":"left",Flotr.drawText(k,g.label,r,s,q)}c=l.y,q.color=c.options.color||j.grid.color;for(e=0;e<c.ticks.length&&c.options.showLabels;++e){g=c.ticks[e],g.label+="";if(!g.label||g.label.length==0)continue;q.angle=Flotr.toRad(c.options.labelsAngle),q.textBaseline="middle",q.textAlign="left",Flotr.drawText(k,g.label,3,-(c.ticks[e].v/c.max)*(m-j.fontSize),q)}for(e=0;e<c.minorTicks.length&&c.options.showMinorLabels;++e){g=c.minorTicks[e],g.label+="";if(!g.label||g.label.length==0)continue;q.angle=Flotr.toRad(c.options.labelsAngle),q.textBaseline="middle",q.textAlign="left",Flotr.drawText(k,g.label,3,-(c.ticks[e].v/c.max)*(m-j.fontSize),q)}k.restore()}else if(!j.HtmlText&&this.textEnabled){var q={size:j.fontSize};c=l.x,q.color=c.options.color||j.grid.color;for(e=0;e<c.ticks.length&&c.options.showLabels&&c.used;++e){g=c.ticks[e];if(!g.label||g.label.length==0)continue;h=c.d2p(g.v);if(h<0||h>this.plotWidth)continue;q.angle=Flotr.toRad(c.options.labelsAngle),q.textAlign="center",q.textBaseline="top",q=Flotr.getBestTextAlign(q.angle,q),Flotr.drawText(k,g.label,this.plotOffset.left+h,this.plotOffset.top+this.plotHeight+j.grid.labelMargin,q)}c=l.x2,q.color=c.options.color||j.grid.color;for(e=0;e<c.ticks.length&&c.options.showLabels&&c.used;++e){g=c.ticks[e];if(!g.label||g.label.length==0)continue;h=c.d2p(g.v);if(h<0||h>this.plotWidth)continue;q.angle=Flotr.toRad(c.options.labelsAngle),q.textAlign="center",q.textBaseline="bottom",q=Flotr.getBestTextAlign(q.angle,q),Flotr.drawText(k,g.label,this.plotOffset.left+h,this.plotOffset.top+j.grid.labelMargin,q)}c=l.y,q.color=c.options.color||j.grid.color;for(e=0;e<c.ticks.length&&c.options.showLabels&&c.used;++e){g=c.ticks[e];if(!g.label||g.label.length==0)continue;i=c.d2p(g.v);if(i<0||i>this.plotHeight)continue;q.angle=Flotr.toRad(c.options.labelsAngle),q.textAlign="right",q.textBaseline="middle",q=Flotr.getBestTextAlign(q.angle,q),Flotr.drawText(k,g.label,this.plotOffset.left-j.grid.labelMargin,this.plotOffset.top+i,q)}c=l.y2,q.color=c.options.color||j.grid.color;for(e=0;e<c.ticks.length&&c.options.showLabels&&c.used;++e){g=c.ticks[e];if(!g.label||g.label.length==0)continue;i=c.d2p(g.v);if(i<0||i>this.plotHeight)continue;q.angle=Flotr.toRad(c.options.labelsAngle),q.textAlign="left",q.textBaseline="middle",q=Flotr.getBestTextAlign(q.angle,q),Flotr.drawText(k,g.label,this.plotOffset.left+this.plotWidth+j.grid.labelMargin,this.plotOffset.top+i,q),k.save(),k.strokeStyle=q.color,k.beginPath(),k.moveTo(this.plotOffset.left+this.plotWidth-8,this.plotOffset.top+c.d2p(g.v)),k.lineTo(this.plotOffset.left+this.plotWidth,this.plotOffset.top+c.d2p(g.v)),k.stroke(),k.restore()}}else if(l.x.options.showLabels||l.x2.options.showLabels||l.y.options.showLabels||l.y2.options.showLabels){f=[],c=l.x;if(c.options.showLabels)for(e=0;e<c.ticks.length;++e){g=c.ticks[e];if(!g.label||g.label.length==0||this.plotOffset.left+c.d2p(g.v)<0||this.plotOffset.left+c.d2p(g.v)>this.canvasWidth)continue;f.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight+j.grid.labelMargin,"px;left:",this.plotOffset.left+c.d2p(g.v)-d/2,"px;width:",d,"px;text-align:center;",c.options.color?"color:"+c.options.color+";":"",'" class="flotr-grid-label">',g.label,"</div>")}c=l.x2;if(c.options.showLabels&&c.used)for(e=0;e<c.ticks.length;++e){g=c.ticks[e];if(!g.label||g.label.length==0||this.plotOffset.left+c.d2p(g.v)<0||this.plotOffset.left+c.d2p(g.v)>this.canvasWidth)continue;f.push('<div style="position:absolute;top:',this.plotOffset.top-j.grid.labelMargin-c.maxLabel.height,"px;left:",this.plotOffset.left+c.d2p(g.v)-d/2,"px;width:",d,"px;text-align:center;",c.options.color?"color:"+c.options.color+";":"",'" class="flotr-grid-label">',g.label,"</div>")}c=l.y;if(c.options.showLabels)for(e=0;e<c.ticks.length;++e){g=c.ticks[e];if(!g.label||g.label.length==0||this.plotOffset.top+c.d2p(g.v)<0||this.plotOffset.top+c.d2p(g.v)>this.canvasHeight)continue;f.push('<div style="position:absolute;top:',this.plotOffset.top+c.d2p(g.v)-c.maxLabel.height/2,"px;left:0;width:",this.plotOffset.left-j.grid.labelMargin,"px;text-align:right;",c.options.color?"color:"+c.options.color+";":"",'" class="flotr-grid-label flotr-grid-label-y">',g.label,"</div>")}c=l.y2;if(c.options.showLabels&&c.used){k.save(),k.strokeStyle=c.options.color||j.grid.color,k.beginPath();for(e=0;e<c.ticks.length;++e){g=c.ticks[e];if(!g.label||g.label.length==0||this.plotOffset.top+c.d2p(g.v)<0||this.plotOffset.top+c.d2p(g.v)>this.canvasHeight)continue;f.push('<div style="position:absolute;top:',this.plotOffset.top+c.d2p(g.v)-c.maxLabel.height/2,"px;right:0;width:",this.plotOffset.right-j.grid.labelMargin,"px;text-align:left;",c.options.color?"color:"+c.options.color+";":"",'" class="flotr-grid-label flotr-grid-label-y">',g.label,"</div>"),k.moveTo(this.plotOffset.left+this.plotWidth-8,this.plotOffset.top+c.d2p(g.v)),k.lineTo(this.plotOffset.left+this.plotWidth,this.plotOffset.top+c.d2p(g.v))}k.stroke(),k.restore()}f=f.join("");var t=a.create("div");a.setStyles(t,{fontSize:"smaller",color:j.grid.color}),t.className="flotr-labels",a.insert(this.el,t),a.insert(t,f)}},drawTitles:function(){var b,c=this.options,d=c.grid.labelMargin,e=this.ctx,f=this.axes;if(!c.HtmlText&&this.textEnabled){var g={size:c.fontSize,color:c.grid.color,textAlign:"center"};c.subtitle&&Flotr.drawText(e,c.subtitle,this.plotOffset.left+this.plotWidth/2,this.titleHeight+this.subtitleHeight-2,g),g.weight=1.5,g.size*=1.5,c.title&&Flotr.drawText(e,c.title,this.plotOffset.left+this.plotWidth/2,this.titleHeight-2,g),g.weight=1.8,g.size*=.8,f.x.options.title&&f.x.used&&(g.textAlign=f.x.options.titleAlign||"center",g.textBaseline="top",g.angle=Flotr.toRad(f.x.options.titleAngle),g=Flotr.getBestTextAlign(g.angle,g),Flotr.drawText(e,f.x.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+f.x.maxLabel.height+this.plotHeight+2*d,g)),f.x2.options.title&&f.x2.used&&(g.textAlign=f.x2.options.titleAlign||"center",g.textBaseline="bottom",g.angle=Flotr.toRad(f.x2.options.titleAngle),g=Flotr.getBestTextAlign(g.angle,g),Flotr.drawText(e,f.x2.options.title,this.plotOffset.left+this.plotWidth/2,this.plotOffset.top-f.x2.maxLabel.height-2*d,g)),f.y.options.title&&f.y.used&&(g.textAlign=f.y.options.titleAlign||"right",g.textBaseline="middle",g.angle=Flotr.toRad(f.y.options.titleAngle),g=Flotr.getBestTextAlign(g.angle,g),Flotr.drawText(e,f.y.options.title,this.plotOffset.left-f.y.maxLabel.width-2*d,this.plotOffset.top+this.plotHeight/2,g)),f.y2.options.title&&f.y2.used&&(g.textAlign=f.y2.options.titleAlign||"left",g.textBaseline="middle",g.angle=Flotr.toRad(f.y2.options.titleAngle),g=Flotr.getBestTextAlign(g.angle,g),Flotr.drawText(e,f.y2.options.title,this.plotOffset.left+this.plotWidth+f.y2.maxLabel.width+2*d,this.plotOffset.top+this.plotHeight/2,g))}else{b=[],c.title&&b.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;font-size:1em;font-weight:bold;text-align:center;width:",this.plotWidth,'px;" class="flotr-title">',c.title,"</div>"),c.subtitle&&b.push('<div style="position:absolute;top:',this.titleHeight,"px;left:",this.plotOffset.left,"px;font-size:smaller;text-align:center;width:",this.plotWidth,'px;" class="flotr-subtitle">',c.subtitle,"</div>"),b.push("</div>"),b.push('<div class="flotr-axis-title" style="font-weight:bold;">'),f.x.options.title&&f.x.used&&b.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight+c.grid.labelMargin+f.x.titleSize.height,"px;left:",this.plotOffset.left,"px;width:",this.plotWidth,'px;text-align:center;" class="flotr-axis-title">',f.x.options.title,"</div>"),f.x2.options.title&&f.x2.used&&b.push('<div style="position:absolute;top:0;left:',this.plotOffset.left,"px;width:",this.plotWidth,'px;text-align:center;" class="flotr-axis-title">',f.x2.options.title,"</div>"),f.y.options.title&&f.y.used&&b.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-f.y.titleSize.height/2,'px;left:0;text-align:right;" class="flotr-axis-title">',f.y.options.title,"</div>"),f.y2.options.title&&f.y2.used&&b.push('<div style="position:absolute;top:',this.plotOffset.top+this.plotHeight/2-f.y.titleSize.height/2,'px;right:0;text-align:right;" class="flotr-axis-title">',f.y2.options.title,"</div>"),b=b.join("");var h=a.create("div");a.setStyles({color:c.grid.color}),h.className="flotr-titles",a.insert(this.el,h),a.insert(h,b)}},drawSeries:function(a){a=a||this.series;var b=!1;for(type in Flotr.graphTypes)a[type]&&a[type].show&&(b=!0,this[type].draw(a));b||this[this.options.defaultType].draw(a)},getEventPosition:function(c){var d=a.position(this.overlay),e=b(c),f=e.x-d.left-this.plotOffset.left,g=e.y-d.top-this.plotOffset.top;return{x:this.axes.x.p2d(f),x2:this.axes.x2.p2d(f),y:this.axes.y.p2d(g),y2:this.axes.y2.p2d(g),relX:f,relY:g,absX:e.x,absY:e.y}},clickHandler:function(a){if(this.ignoreClick){this.ignoreClick=!1;return this.ignoreClick}Flotr.EventAdapter.fire(this.el,"flotr:click",[this.getEventPosition(a),this])},mouseMoveHandler:function(a){var b=this.getEventPosition(a);this.lastMousePos.pageX=b.absX,this.lastMousePos.pageY=b.absY,this.options.crosshair.mode&&this.clearCrosshair(),this.selectionInterval==null&&(this.options.mouse.track||_.any(this.series,function(a){return a.mouse&&a.mouse.track}))&&this.hit(b),this.options.crosshair.mode&&this.drawCrosshair(b),Flotr.EventAdapter.fire(this.el,"flotr:mousemove",[a,b,this])},mouseDownHandler:function(a){function c(a,b){return a.which?a.which===1:a.button===0||a.button===1}if(!!this.options.selection.mode&&!!c(a)){var d=b(a);this.setSelectionPos(this.selection.first,{pageX:d.x,pageY:d.y}),this.selectionInterval!=null&&clearInterval(this.selectionInterval),this.lastMousePos.pageX=null,this.selectionInterval=setInterval(_.bind(this.updateSelection,this),1e3/this.options.selection.fps),this.mouseUpHandler=_.bind(this.mouseUpHandler,this),Flotr.EventAdapter.observe(document,"mouseup",this.mouseUpHandler)}},fireSelectEvent:function(){var a=this.axes,b=this.selection,c,d,e,f;c=a.x.p2d(b.first.x),d=a.x.p2d(b.second.x),e=a.y.p2d(b.first.y),f=a.y.p2d(b.second.y),Flotr.EventAdapter.fire(this.el,"flotr:select",[{x1:Math.min(c,d),y1:Math.min(e,f),x2:Math.max(c,d),y2:Math.max(e,f),xfirst:c,xsecond:d,yfirst:e,ysecond:f},this])},mouseUpHandler:function(a){Flotr.EventAdapter.stopObserving(document,"mouseup",this.mouseUpHandler),this.selectionInterval!=null&&(clearInterval(this.selectionInterval),this.selectionInterval=null);var c=b(a);this.setSelectionPos(this.selection.second,{pageX:c.x,pageY:c.y}),this.clearSelection(),this.selectionIsSane()&&(this.drawSelection(),this.fireSelectEvent(),this.ignoreClick=!0)},setSelectionPos:function(b,c){var d=this.options,e=a.position(this.overlay);d.selection.mode.indexOf("x")==-1?b.x=b==this.selection.first?0:this.plotWidth:(b.x=c.pageX-e.left-this.plotOffset.left,b.x=Math.min(Math.max(0,b.x),this.plotWidth)),d.selection.mode.indexOf("y")==-1?b.y=b==this.selection.first?0:this.plotHeight:(b.y=c.pageY-e.top-this.plotOffset.top,b.y=Math.min(Math.max(0,b.y),this.plotHeight))},updateSelection:function(){this.lastMousePos.pageX!=null&&(this.setSelectionPos(this.selection.second,this.lastMousePos),this.clearSelection(),this.selectionIsSane()&&this.drawSelection())},clearSelection:function(){if(this.prevSelection!=null){var a=this.prevSelection,b=this.octx.lineWidth,c=this.plotOffset,d=Math.min(a.first.x,a.second.x),e=Math.min(a.first.y,a.second.y),f=Math.abs(a.second.x-a.first.x),g=Math.abs(a.second.y-a.first.y);this.octx.clearRect(d+c.left-b/2+.5,e+c.top-b/2+.5,f+b,g+b),this.prevSelection=null}},setSelection:function(a,b){var c=this.options,d=this.axes.x,e=this.axes.y,f=e.scale,g=d.scale,h=c.selection.mode.indexOf("x")!=-1,i=c.selection.mode.indexOf("y")!=-1;this.clearSelection(),this.selection.first.y=h&&!i?0:(e.max-a.y1)*f,this.selection.second.y=h&&!i?this.plotHeight:(e.max-a.y2)*f,this.selection.first.x=i&&!h?0:(a.x1-d.min)*g,this.selection.second.x=i&&!h?this.plotWidth:(a.x2-d.min)*g,this.drawSelection(),b||this.fireSelectEvent()},drawSelection:function(){var a=this.prevSelection,b=this.selection,c=this.octx,d=this.options,e=this.plotOffset;if(a==null||b.first.x!=a.first.x||b.first.y!=a.first.y||b.second.x!=a.second.x||b.second.y!=a.second.y){c.save(),c.strokeStyle=this.processColor(d.selection.color,{opacity:.8}),c.lineWidth=1,c.lineJoin="miter",c.fillStyle=this.processColor(d.selection.color,{opacity:.4}),this.prevSelection={first:{x:b.first.x,y:b.first.y},second:{x:b.second.x,y:b.second.y}};var f=Math.min(b.first.x,b.second.x),g=Math.min(b.first.y,b.second.y),h=Math.abs(b.second.x-b.first.x),i=Math.abs(b.second.y-b.first.y);c.fillRect(f+e.left+.5,g+e.top+.5,h,i),c.strokeRect(f+e.left+.5,g+e.top+.5,h,i),c.restore()}},drawCrosshair:function(b){var c=this.octx,d=this.options,e=this.plotOffset,f=e.left+b.relX+.5,g=e.top+b.relY+.5;b.relX<0||b.relY<0||b.relX>this.plotWidth||b.relY>this.plotHeight?(this.el.style.cursor=null,a.removeClass(this.el,"flotr-crosshair")):(this.lastMousePos.relX=null,this.lastMousePos.relY=null,d.crosshair.hideCursor&&(this.el.style.cursor="none",a.addClass(this.el,"flotr-crosshair")),c.save(),c.strokeStyle=d.crosshair.color,c.lineWidth=1,c.beginPath(),d.crosshair.mode.indexOf("x")!=-1&&(c.moveTo(f,e.top),c.lineTo(f,e.top+this.plotHeight),this.lastMousePos.relX=f),d.crosshair.mode.indexOf("y")!=-1&&(c.moveTo(e.left,g),c.lineTo(e.left+this.plotWidth,g),this.lastMousePos.relY=g),c.stroke(),c.restore())},clearCrosshair:function(){this.lastMousePos.relX!=null&&this.octx.clearRect(this.lastMousePos.relX-.5,this.plotOffset.top,1,this.plotHeight+1),this.lastMousePos.relY!=null&&this.octx.clearRect(this.plotOffset.left,this.lastMousePos.relY-.5,this.plotWidth+1,1)},selectionIsSane:function(){return Math.abs(this.selection.second.x-this.selection.first.x)>=5&&Math.abs(this.selection.second.y-this.selection.first.y)>=5},clearHit:function(){var a=this.prevHit;if(a&&!this.executeOnType(a.series,"clearHit")){var b=this.plotOffset,c=a.series,d=c.bars?c.bars.lineWidth:1,e=c.mouse.radius+d;this.octx.clearRect(b.left+a.xaxis.d2p(a.x)-e,b.top+a.yaxis.d2p(a.y)-e,e*2,e*2)}},drawHit:function(a){var b=this.octx,c=a.series;if(c.mouse.lineColor!=null){b.save(),b.lineWidth=c.points?c.points.lineWidth:1,b.strokeStyle=c.mouse.lineColor,b.fillStyle=this.processColor(c.mouse.fillColor||"#ffffff",{opacity:c.mouse.fillOpacity});if(!this.executeOnType(c,"drawHit",[a])){var d=a.xaxis,e=a.yaxis;b.translate(this.plotOffset.left,this.plotOffset.top),b.beginPath(),b.arc(d.d2p(a.x),e.d2p(a.y),c.mouse.radius,0,2*Math.PI,!0),b.fill(),b.stroke(),b.closePath()}b.restore()}this.prevHit=a},hit:function(b){var c=this.series,d=this.options,e=this.prevHit,f=this.plotOffset,g=this.octx,h,i,j,k,l,m,n,o,p,q,r,s={dist:Number.MAX_VALUE,x:null,y:null,relX:b.relX,relY:b.relY,absX:b.absX,absY:b.absY,sAngle:null,eAngle:null,fraction:null,mouse:null,xaxis:null,yaxis:null,series:null,index:null,seriesIndex:null};if(d.mouse.trackAll)for(r=0;r<c.length;r++){B=c[0],h=B.data,n=B.xaxis,o=B.yaxis,j=2*d.points.lineWidth/n.scale*B.mouse.sensibility,p=n.p2d(b.relX),q=o.p2d(b.relY);for(var t=0;t<h.length;t++){l=h[t][0],m=h[t][1];if(m===null||n.min>l||n.max<l||o.min>m||o.max<m||p<n.min||p>n.max||q<o.min||q>o.max)continue;var u=Math.abs(l-p);if(!B.bars.show&&u<j||B.bars.show&&u<B.bars.barWidth/2||m<0&&q<0&&q>m){var v=u;v<s.dist&&(s.dist=v,s.x=l,s.y=m,s.xaxis=n,s.yaxis=o,s.mouse=B.mouse,s.series=B,s.allSeries=c,s.index=t)}}}else if(!this.executeOnType(c,"hit",[b,s]))for(r=0;r<c.length;r++){B=c[r];if(!B.mouse.track)continue;h=B.data,n=B.xaxis,o=B.yaxis,i=2*(d.points?d.points.lineWidth:1)*B.mouse.sensibility,j=i/n.scale,k=i/o.scale,p=n.p2d(b.relX),q=o.p2d(b.relY);for(var t=0,w,x;t<h.length;t++){l=h[t][0],m=h[t][1];if(m===null||n.min>l||n.max<l||o.min>m||o.max<m)continue;if(B.bars.show&&B.bars.centered)var u=Math.abs(l-p),y=Math.abs(m-q);else if(B.bars.horizontal)var u=Math.abs(l-p),y=Math.abs(m+B.bars.barWidth/2-q);else var u=Math.abs(l+B.bars.barWidth/2-p),y=Math.abs(m-q);if(!B.bars.show&&u<j&&(!B.mouse.trackY||y<k)||B.bars.show&&!B.bars.horizontal&&u<B.bars.barWidth/2+1/n.scale&&(!B.mouse.trackY||m>0&&q>0&&q<m||m<0&&q<0&&q>m)||B.bars.horizontal&&y<B.bars.barWidth/2+1/o.scale&&(l>0&&p>0&&p<l||l<0&&p<0&&p>l)){var v=Math.sqrt(u*u+y*y);v<s.dist&&(s.dist=v,s.x=l,s.y=m,s.xaxis=n,s.yaxis=o,s.mouse=B.mouse,s.series=B,s.allSeries=c,s.index=t,s.seriesIndex=r)}}}if(s.series&&(s.mouse&&s.mouse.track&&!e||e)){var z=this.getMouseTrack(),A="",B=s.series,C=s.mouse.position,E=s.mouse.margin,F="opacity:0.7;background-color:#000;color:#fff;display:none;position:absolute;padding:2px 8px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;";if(!s.mouse.relative)C.charAt(0)=="n"?A+="top:"+(E+f.top)+"px;bottom:auto;":C.charAt(0)=="s"&&(A+="bottom:"+(E+f.bottom)+"px;top:auto;"),C.charAt(1)=="e"?A+="right:"+(E+f.right)+"px;left:auto;":C.charAt(1)=="w"&&(A+="left:"+(E+f.left)+"px;right:auto;");else if(!B.bars.show&&!B.pie.show)C.charAt(0)=="n"?A+="bottom:"+(E-f.top-s.yaxis.d2p(s.y)+this.canvasHeight)+"px;top:auto;":C.charAt(0)=="s"&&(A+="top:"+(E+f.top+s.yaxis.d2p(s.y))+"px;bottom:auto;"),C.charAt(1)=="e"?A+="left:"+(E+f.left+s.xaxis.d2p(s.x))+"px;right:auto;":C.charAt(1)=="w"&&(A+="right:"+(E-f.left-s.xaxis.d2p(s.x)+this.canvasWidth)+"px;left:auto;");else if(B.bars.show)A+="bottom:"+(E-f.top-s.yaxis.d2p(s.y/2)+this.canvasHeight)+"px;top:auto;",A+="left:"+(E+f.left+s.xaxis.d2p(s.x-d.bars.barWidth/2))+"px;right:auto;";else{var G={x:this.plotWidth/2,y:this.plotHeight/2},H=Math.min(this.canvasWidth,this.canvasHeight)*B.pie.sizeRatio/2,I=s.sAngle<s.eAngle?(s.sAngle+s.eAngle)/2:(s.sAngle+s.eAngle+2*Math.PI)/2;A+="bottom:"+(E-f.top-G.y-Math.sin(I)*H/2+this.canvasHeight)+"px;top:auto;",A+="left:"+(E+f.left+G.x+Math.cos(I)*H/2)+"px;right:auto;"}F+=A,z.style.cssText=F;if(s.x!==null&&s.y!==null){a.show(z),this.clearHit(),this.drawHit(s);var J=s.mouse.trackDecimals;if(J==null||J<0)J=0;z.innerHTML=s.mouse.trackFormatter({x:s.x.toFixed(J),y:s.y.toFixed(J),series:s.series,index:s.index,nearest:s,fraction:s.fraction}),Flotr.EventAdapter.fire(z,"flotr:hit",[s,this])}else e&&(a.hide(z),this.clearHit())}else this.prevHit&&(a.hide(this.mouseTrack),this.clearHit())},getMouseTrack:function(){this.mouseTrack||(this.mouseTrack=a.node('<div class="flotr-mouse-value"></div>'),a.insert(this.el,this.mouseTrack));return this.mouseTrack},drawTooltip:function(b,c,d,e){var f=this.getMouseTrack(),g="opacity:0.7;background-color:#000;color:#fff;display:none;position:absolute;padding:2px 8px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;",h=e.position,i=e.margin,j=this.plotOffset;c!==null&&d!==null?(e.relative?(h.charAt(0)=="n"?g+="bottom:"+(i-j.top-d+this.canvasHeight)+"px;top:auto;":h.charAt(0)=="s"&&(g+="top:"+(i+j.top+d)+"px;bottom:auto;"),h.charAt(1)=="e"?g+="left:"+(i+j.left+c)+"px;right:auto;":h.charAt(1)=="w"&&(g+="right:"+(i-j.left-c+this.canvasWidth)+"px;left:auto;")):(h.charAt(0)=="n"?g+="top:"+(i+j.top)+"px;bottom:auto;":h.charAt(0)=="s"&&(g+="bottom:"+(i+j.bottom)+"px;top:auto;"),h.charAt(1)=="e"?g+="right:"+(i+j.right)+"px;left:auto;":h.charAt(1)=="w"&&(g+="left:"+(i+j.left)+"px;right:auto;")),f.style.cssText=g,a.empty(f),a.insert(f,b),a.show(f)):a.hide(f)},saveImage:function(b,c,d,e){var f=null;if(Flotr.isIE&&Flotr.isIE<9){f="<html><body>"+this.canvas.firstChild.innerHTML+"</body></html>";return window.open().document.write(f)}switch(b){case"jpeg":case"jpg":f=Canvas2Image.saveAsJPEG(this.canvas,e,c,d);break;default:case"png":f=Canvas2Image.saveAsPNG(this.canvas,e,c,d);break;case"bmp":f=Canvas2Image.saveAsBMP(this.canvas,e,c,d)}_.isElement(f)&&e&&(this.restoreCanvas(),a.hide(this.canvas),a.hide(this.overlay),a.setStyles({position:"absolute"}),a.insert(this.el,f),this.saveImageElement=f)},restoreCanvas:function(){a.show(this.canvas),a.show(this.overlay),this.canvas.show(),this.overlay.show(),this.saveImageElement&&this.el.removeChild(this.saveImageElement),this.saveImageElement=null}}}(),Flotr.addType("lines",{options:{show:!1,lineWidth:2,fill:!1,fillColor:null,fillOpacity:.4,stacked:!1},draw:function(a){a=a||this.series;var b=this.ctx;b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.lineJoin="round";var c=a.lines.lineWidth,d=a.shadowSize;if(d>0){b.lineWidth=d/2;var e=c/2+b.lineWidth/2;b.strokeStyle="rgba(0,0,0,0.1)",this.lines.plot(a,e+d/2,!1),b.strokeStyle="rgba(0,0,0,0.2)",this.lines.plot(a,e,!1),a.lines.fill&&(b.fillStyle="rgba(0,0,0,0.05)",this.lines.plotArea(a,e+d/2,!1))}b.lineWidth=c,b.strokeStyle=a.color,a.lines.fill&&(b.fillStyle=this.processColor(a.lines.fillColor||a.color,{opacity:a.lines.fillOpacity}),this.lines.plotArea(a,0,!0)),this.lines.plot(a,0,!0),b.restore()},plot:function(a,b,c){var d=this.ctx,e=a.xaxis,f=a.yaxis,g=a.data,h=g.length-1,i;if(!(g.length<2)){var j=this.plotWidth,k=this.plotHeight,l=null,m=null;d.beginPath();for(i=0;i<h;++i){if(g[i][1]===null||g[i+1][1]===null)continue;if(e.options.scaling==="logarithmic"&&(g[i][0]<=0||g[i+1][0]<=0))continue;if(f.options.scaling=="logarithmic"&&(g[i][1]<=0||g[i+1][1]<=0))continue;var n=e.d2p(g[i][0]),o,p=e.d2p(g[i+1][0]),q;if(a.lines.stacked){var r=e.values[g[i][0]].stack||0,s=e.values[g[i+1][0]].stack||e.values[g[i][0]].stack||0;o=f.d2p(g[i][1]+r),q=f.d2p(g[i+1][1]+s),c&&(e.values[g[i][0]].stack=g[i][1]+r,i==h-1&&(e.values[g[i+1][0]].stack=g[i+1][1]+s))}else o=f.d2p(g[i][1]),q=f.d2p(g[i+1][1]);if(o>=q&&o>=k){if(q>=k)continue;n=n-(o-k-1)/(q-o)*(p-n),o=k-1}else if(q>=o&&q>=k){if(o>=k)continue;p=n-(o-k-1)/(q-o)*(p-n),q=k-1}if(o<=q&&o<0){if(q<0)continue;n=n-o/(q-o)*(p-n),o=0}else if(q<=o&&q<0){if(o<0)continue;p=n-o/(q-o)*(p-n),q=0}if(n<=p&&n<0){if(p<0)continue;o=o-n/(p-n)*(q-o),n=0}else if(p<=n&&p<0){if(n<0)continue;q=o-n/(p-n)*(q-o),p=0}if(n>=p&&n>=j){if(p>=j)continue;o=o+(j-n)/(p-n)*(q-o),n=j-1}else if(p>=n&&p>=j){if(n>=j)continue;q=o+(j-n)/(p-n)*(q-o),p=j-1}(l!=n||m!=o+b)&&d.moveTo(n,o+b),l=p,m=q+b,d.lineTo(l,m)}d.stroke(),d.closePath()}},plotArea:function(a,b,c){function q(a,b){c&&(m[n]=[],m[n][0]=a,m[n][1]=b,n++)}var d=this.ctx,e=a.xaxis,f=a.yaxis,g=a.data,h=g.length-1,i,j=Math.min(Math.max(0,f.min),f.max),k=0,l=!0,m=[],n=0,o=0,p=0;if(!(g.length<2)){d.beginPath();for(var r=0;r<h;++r){var s=g[r][0],t,u=g[r+1][0],v;if(a.lines.stacked){var o=e.values[g[r][0]].stack||0,p=e.values[g[r+1][0]].stack||e.values[g[r][0]].stack||0;t=g[r][1]+o,v=g[r+1][1]+p}else t=g[r][1],v=g[r+1][1];if(s<=u&&s<e.min){if(u<e.min)continue;t=(e.min-s)/(u-s)*(v-t)+t,s=e.min}else if(u<=s&&u<e.min){if(s<e.min)continue;v=(e.min-s)/(u-s)*(v-t)+t,u=e.min}if(s>=u&&s>e.max){if(u>e.max)continue;t=(e.max-s)/(u-s)*(v-t)+t,s=e.max}else if(u>=s&&u>e.max){if(s>e.max)continue;v=(e.max-s)/(u-s)*(v-t)+t,u=e.max}var w=e.d2p(s),x=e.d2p(u),y=f.d2p(f.max),z=f.d2p(f.min);l&&(d.moveTo(w,f.d2p(j+o)+b),q(w,f.d2p(j+o)+b),l=!1),k=Math.max(u,k);if(t>=f.max&&v>=f.max){d.lineTo(w,y+b),d.lineTo(x,y+b),q(w,y+b),q(x,y+b);continue}if(t<=f.min&&v<=f.min){d.lineTo(w,z+b),d.lineTo(x,z+b),q(w,z+b),q(x,z+b);continue}var A=s,B=u;t<=v&&t<f.min&&v>=f.min?(s=(f.min-t)/(v-t)*(u-s)+s,t=f.min):v<=t&&v<f.min&&t>=f.min&&(u=(f.min-t)/(v-t)*(u-s)+s,v=f.min),t>=v&&t>f.max&&v<=f.max?(s=(f.max-t)/(v-t)*(u-s)+s,t=f.max):v>=t&&v>f.max&&t<=f.max&&(u=(f.max-t)/(v-t)*(u-s)+s,v=f.max);var C=e.d2p(s),D=e.d2p(u),E=f.d2p(t),F=f.d2p(v);s!=A&&(i=t<=f.min?z:y,d.lineTo(w,i+b),d.lineTo(C,i+b),q(w,i+b),q(C,i+b)),d.lineTo(C,E+b),d.lineTo(D,F+b),q(C,E+b),q(D,F+b),u!=B&&(i=v<=f.min?z:y,d.lineTo(x,i+b),q(x,i+b)),k=Math.max(u,B,k)}d.lineTo(e.d2p(k),f.d2p(j)+b),q(e.d2p(k),f.d2p(j)+b);var G=e.lastStrokePath;if(a.lines.stacked){if(G)for(var r=G.length-1;r>=0;--r)d.lineTo(G[r][0],G[r][1]-b/2);c&&(e.lastStrokePath=m)}d.closePath(),d.fill()}},extendYRange:function(a){if(a.options.max==null||a.options.min==null){var b=a.max,c=a.min,d,e,f,g,h,i={},j={},k=null;for(e=0;e<this.series.length;++e){g=this.series[e],h=g.lines;if(h.show&&!g.hide&&g.yaxis==a&&h.stacked){for(f=0;f<g.data.length;f++)d=g.data[f][0]+"",g.data[f][1]>0?i[d]=(i[d]||0)+g.data[f][1]:j[d]=(j[d]||0)+g.data[f][1],k=g;for(f in i)b=Math.max(i[f],b);for(f in j)c=Math.min(j[f],c)}}a.lastSerie=k,a.max=b,a.min=c}}}),Flotr.addType("bars",{options:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,fillOpacity:.4,horizontal:!1,stacked:!1,centered:!0},draw:function(a){var b=this.ctx,c=a.bars.barWidth,d=Math.min(a.bars.lineWidth,c);b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.lineJoin="miter",b.lineWidth=d,b.strokeStyle=a.color,b.save(),this.bars.plotShadows(a,c,0,a.bars.fill),b.restore();if(a.bars.fill){var e=a.bars.fillColor||a.color;b.fillStyle=this.processColor(e,{opacity:a.bars.fillOpacity})}this.bars.plot(a,c,0,a.bars.fill),b.restore()},plot:function(a,b,c,d){var e=a.data;if(!(e.length<1)){var f=a.xaxis,g=a.yaxis,h=this.ctx,i;for(i=0;i<e.length;i++){var j=e[i][0],k=e[i][1],l=!0,m=!0,n=!0;if(k===null)continue;var o=0,p=0;a.bars.stacked&&(a.bars.horizontal?(o=g.values[k].stackPos||0,p=g.values[k].stackNeg||0,j>0?g.values[k].stackPos=o+j:g.values[k].stackNeg=p+j):(o=f.values[j].stackPos||0,p=f.values[j].stackNeg||0,k>0?f.values[j].stackPos=o+k:f.values[j].stackNeg=p+k));var q=a.bars.centered?b/2:0;if(a.bars.horizontal){if(j>0)var r=o,s=j+o;else var s=p,r=j+p;var t=k-q,u=k+b-q}else{if(k>0)var t=o,u=k+o;else var u=p,t=k+p;var r=j-q,s=j+b-q}if(s<f.min||r>f.max||u<g.min||t>g.max)continue;r<f.min&&(r=f.min,l=!1),s>f.max&&(s=f.max,f.lastSerie!=a&&a.bars.horizontal&&(m=!1)),t<g.min&&(t=g.min),u>g.max&&(u=g.max,g.lastSerie!=a&&!a.bars.horizontal&&(m=!1));var v=f.d2p(r),w=f.d2p(s),x=g.d2p(u),y=g.d2p(t);d&&h.fillRect(v,x,w-v,y-x),a.bars.lineWidth!=0&&(l||n||m)&&(h.beginPath(),h.moveTo(v,y+c),h[l?"lineTo":"moveTo"](v,x+c),h[m?"lineTo":"moveTo"](w,x+c),h[n?"lineTo":"moveTo"](w,y+c),h.stroke(),h.closePath())}}},plotShadows:function(a,b,c){var d=a.data;if(!(d.length<1)){var e,f,g,h=a.xaxis,i=a.yaxis,j=this.ctx,k=this.options.shadowSize;for(e=0;e<d.length;e++){f=d[e][0],g=d[e][1];if(g===null)continue;var l=0,m=0;a.bars.stacked&&(a.bars.horizontal?(l=i.values[g].stackShadowPos||0,m=i.values[g].stackShadowNeg||0,f>0?i.values[g].stackShadowPos=l+f:i.values[g].stackShadowNeg=m+f):(l=h.values[f].stackShadowPos||0,m=h.values[f].stackShadowNeg||0,g>0?h.values[f].stackShadowPos=l+g:h.values[f].stackShadowNeg=m+g));var n=a.bars.centered?b/2:0;if(a.bars.horizontal){if(f>0)var o=l,p=f+l;else var p=m,o=f+m;var q=g-n,r=g+b-n}else{if(g>0)var q=l,r=g+l;else var r=m,q=g+m;var o=f-n,p=f+b-n}if(p<h.min||o>h.max||r<i.min||q>i.max)continue;o<h.min&&(o=h.min),p>h.max&&(p=h.max),q<i.min&&(q=i.min),r>i.max&&(r=i.max);var s=h.d2p(p)-h.d2p(o)-(h.d2p(p)+k<=this.plotWidth?0:k),t=i.d2p(q)-i.d2p(r)-(i.d2p(q)+k<=this.plotHeight?0:k);j.fillStyle="rgba(0,0,0,0.05)",j.fillRect(Math.min(h.d2p(o)+k,this.plotWidth),Math.min(i.d2p(r)+k,this.plotHeight),s,t)}}},extendXRange:function(a){if(a.options.max==null){var b=a.min,c=a.max,d,e,f,g,h,i={},j={},k=null;for(d=0;d<this.series.length;++d){g=this.series[d],h=g.bars;if(h.show&&g.xaxis==a){h.centered&&!h.horizontal&&(c=Math.max(a.datamax+.5,c),b=Math.min(a.datamin-.5,b)),!h.horizontal&&h.barWidth+a.datamax>c&&(c=a.max+(h.centered?h.barWidth/2:h.barWidth));if(h.stacked&&h.horizontal){for(e=0;e<g.data.length;e++)h.show&&h.stacked&&(y=g.data[e][1]+"",g.data[e][0]>0?i[y]=(i[y]||0)+g.data[e][0]:j[y]=(j[y]||0)+g.data[e][0],k=g);for(e in i)c=Math.max(i[e],c);for(e in j)b=Math.min(j[e],b)}}}a.lastSerie=k,a.max=c,a.min=b}},extendYRange:function(a){if(a.options.max==null){var b=a.max,c=a.min,d,e,f,g,h,i={},j={},k=null;for(e=0;e<this.series.length;++e){g=this.series[e],h=g.bars;if(h.show&&!g.hide&&g.yaxis==a){h.centered&&h.horizontal&&(b=Math.max(a.datamax+.5,b),c=Math.min(a.datamin-.5,c)),h.horizontal&&h.barWidth+a.datamax>b&&(b=a.max+h.barWidth);if(h.stacked&&!h.horizontal){for(f=0;f<g.data.length;f++)g.bars.show&&g.bars.stacked&&(d=g.data[f][0]+"",g.data[f][1]>0?i[d]=(i[d]||0)+g.data[f][1]:j[d]=(j[d]||0)+g.data[f][1],k=g);for(f in i)b=Math.max(i[f],b);for(f in j)c=Math.min(j[f],c)}}}a.lastSerie=k,a.max=b,a.min=c}},drawHit:function(a){var b=this.octx,c=a.series,d=a.xaxis,e=a.yaxis;b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.beginPath();if(c.mouse.trackAll)b.moveTo(d.d2p(a.x),e.d2p(0)),b.lineTo(d.d2p(a.x),e.d2p(a.yaxis.max));else{var f=c.bars.barWidth,g=e.d2p(a.y),h=d.d2p(a.x);if(!c.bars.horizontal){var i=e.d2p(e.min<0?0:e.min);if(c.bars.centered){var j=d.d2p(a.x-f/2),k=d.d2p(a.x+f/2);b.moveTo(j,i),b.lineTo(j,g),b.lineTo(k,g),b.lineTo(k,i)}else{var k=d.d2p(a.x+f);b.moveTo(h,i),b.lineTo(h,g),b.lineTo(k,g),b.lineTo(k,i)}}else{var j=d.d2p(d.min<0?0:d.min);if(c.bars.centered){var i=e.d2p(a.y-f/2),l=e.d2p(a.y+f/2);b.moveTo(j,i),b.lineTo(h,i),b.lineTo(h,l),b.lineTo(j,l)}else{var l=e.d2p(a.y+f);b.moveTo(j,g),b.lineTo(h,g),b.lineTo(h,l),b.lineTo(j,l)}}c.mouse.fillColor&&b.fill()}b.stroke(),b.closePath(),b.restore()},clearHit:function(){var a=this.prevHit,b=this.plotOffset,c=a.series,d=a.xaxis,e=a.yaxis,f=c.bars.lineWidth,g=c.bars.barWidth;if(!c.bars.horizontal){var h=e.d2p(a.y>=0?a.y:0);c.bars.centered?this.octx.clearRect(d.d2p(a.x-g/2)+b.left-f,h+b.top-f,d.d2p(g+d.min)+f*2,e.d2p(a.y<0?a.y:0)-h+f*2):this.octx.clearRect(d.d2p(a.x)+b.left-f,h+b.top-f,d.d2p(g+d.min)+f*2,e.d2p(a.y<0?a.y:0)-h+f*2)}else{var i=d.d2p(a.x>=0?a.x:0);c.bars.centered?this.octx.clearRect(i+b.left+f,e.d2p(a.y+g/2)+b.top-f,d.d2p(a.x<0?a.x:0)-i-f*2,e.d2p(g+e.min)+f*2):this.octx.clearRect(i+b.left+f,e.d2p(a.y+g)+b.top-f,d.d2p(a.x<0?a.x:0)-i-f*2,e.d2p(g+e.min)+f*2)}},findAxesValues:function(a){this.findXAxesValues(a),a.bars.show&&a.bars.horizontal&&a.bars.stacked&&this.findYAxesValues(a)}}),Flotr.addType("bubbles",{options:{show:!1,lineWidth:2,fill:!0,fillOpacity:.4,baseRadius:2},draw:function(a){var b=this.ctx,c=this.options;b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.lineWidth=a.bubbles.lineWidth,b.fillStyle="rgba(0,0,0,0.05)",b.strokeStyle="rgba(0,0,0,0.05)",this.bubbles.plot(a,a.shadowSize/2),b.strokeStyle="rgba(0,0,0,0.1)",this.bubbles.plot(a,a.shadowSize/4),b.strokeStyle=a.color,b.fillStyle=this.processColor(a.color,{opacity:a.radar.fillOpacity}),this.bubbles.plot(a),b.restore()},plot:function(a,b){var c=this.ctx,d=this.options,e=a.data,f=d.bubbles.baseRadius;b=b||0;for(var g=0;g<e.length;++g){var h=e[g][0],i=e[g][1],j=e[g][2];c.beginPath(),c.arc(a.xaxis.d2p(h)+b,a.yaxis.d2p(i)+b,f*j,0,Math.PI*2,!0),c.stroke(),a.bubbles.fill&&c.fill(),c.closePath()}},drawHit:function(a){var b=this.octx,c=a.series,d=a.xaxis,e=a.yaxis,f=c.data[0][2],g=this.options.bubbles.baseRadius;b.save(),b.lineWidth=c.points.lineWidth,b.strokeStyle=c.mouse.lineColor,b.fillStyle=this.processColor(c.mouse.fillColor||"#ffffff",{opacity:c.mouse.fillOpacity}),b.translate(this.plotOffset.left,this.plotOffset.top),b.beginPath(),b.arc(d.d2p(a.x),e.d2p(a.y),f*g,0,2*Math.PI,!0),b.fill(),b.stroke(),b.closePath(),b.restore()},clearHit:function(){var a=this.prevHit,b=this.plotOffset,c=a.series,d=c.bars.lineWidth,e=a.xaxis,f=a.yaxis,g=c.data[0][2],h=this.options.bubbles.baseRadius,i=g*h+d;this.octx.clearRect(b.left+e.d2p(a.x)-i,b.top+f.d2p(a.y)-i,i*2,i*2)}}),Flotr.addType("candles",{options:{show:!1,lineWidth:1,wickLineWidth:1,candleWidth:.6,fill:!0,upFillColor:"#00A8F0",downFillColor:"#CB4B4B",fillOpacity:.5,barcharts:!1},draw:function(a){var b=this.ctx,c=a.candles.candleWidth;b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.lineJoin="miter",b.lineWidth=a.candles.lineWidth,this.candles.plotShadows(a,c/2),this.candles.plot(a,c/2),b.restore()},plot:function(a,b){var c=a.data;if(!(c.length<1)){var d=a.xaxis,e=a.yaxis,f=this.ctx;for(var g=0;g<c.length;g++){var h=c[g],i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=i-a.candles.candleWidth/2,o=i+a.candles.candleWidth/2,p=Math.max(e.min,l),q=Math.min(e.max,k),r=Math.max(e.min,Math.min(j,m)),s=Math.min(e.max,Math.max(j,m));if(o<d.min||n>d.max||q<e.min||p>e.max)continue;var t=a.candles[j>m?"downFillColor":"upFillColor"];a.candles.fill&&!a.candles.barcharts&&(f.fillStyle=this.processColor(t,{opacity:a.candles.fillOpacity}),f.fillRect(d.d2p(n),e.d2p(s)+b,d.d2p(o)-d.d2p(n),e.d2p(r)-e.d2p(s)));if(a.candles.lineWidth||a.candles.wickLineWidth){var i,u,v=a.candles.wickLineWidth%2/2;i=Math.floor(d.d2p((n+o)/2))+v,f.save(),f.strokeStyle=t,f.lineWidth=a.candles.wickLineWidth,f.lineCap="butt",a.candles.barcharts?(f.beginPath(),f.moveTo(i,Math.floor(e.d2p(q)+b)),f.lineTo(i,Math.floor(e.d2p(p)+b)),u=Math.floor(e.d2p(j)+b)+.5,f.moveTo(Math.floor(d.d2p(n))+v,u),f.lineTo(i,u),u=Math.floor(e.d2p(m)+b)+.5,f.moveTo(Math.floor(d.d2p(o))+v,u),f.lineTo(i,u)):(f.strokeRect(d.d2p(n),e.d2p(s)+b,d.d2p(o)-d.d2p(n),e.d2p(r)-e.d2p(s)),f.beginPath(),f.moveTo(i,Math.floor(e.d2p(s)+b)),f.lineTo(i,Math.floor(e.d2p(q)+b)),f.moveTo(i,Math.floor(e.d2p(r)+b)),f.lineTo(i,Math.floor(e.d2p(p)+b))),f.stroke(),f.closePath(),f.restore()}}}},plotShadows:function(a,b){var c=a.data;if(!(c.length<1||a.candles.barcharts)){var d=a.xaxis,e=a.yaxis,f=this.options.shadowSize;for(var g=0;g<c.length;g++){var h=c[g],i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=i-a.candles.candleWidth/2,o=i+a.candles.candleWidth/2,p=Math.max(e.min,Math.min(j,m)),q=Math.min(e.max,Math.max(j,m));if(o<d.min||n>d.max||q<e.min||p>e.max)continue;var r=d.d2p(o)-d.d2p(n)-(d.d2p(o)+f<=this.plotWidth?0:f),s=Math.max(0,e.d2p(p)-e.d2p(q)-(e.d2p(p)+f<=this.plotHeight?0:f));this.ctx.fillStyle="rgba(0,0,0,0.05)",this.ctx.fillRect(Math.min(d.d2p(n)+f,this.plotWidth),Math.min(e.d2p(q)+f,this.plotWidth),r,s)}}},extendXRange:function(a){if(a.options.max==null){var b=a.min,c=a.max,d,e;for(d=0;d<this.series.length;++d)e=this.series[d].candles,e.show&&this.series[d].xaxis==a&&(c=Math.max(a.datamax+.5,c),b=Math.min(a.datamin-.5,b));a.max=c,a.min=b}}}),Flotr.addType("gantt",{options:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,fillOpacity:.4,centered:!0},draw:function(a){var b=this.ctx,c=a.gantt.barWidth,d=Math.min(a.gantt.lineWidth,c);b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.lineJoin="miter",b.lineWidth=d,b.strokeStyle=a.color,b.save(),this.gantt.plotShadows(a,c,0,a.gantt.fill),b.restore();if(a.gantt.fill){var e=a.gantt.fillColor||a.color;b.fillStyle=this.processColor(e,{opacity:a.gantt.fillOpacity})}this.gantt.plot(a,c,0,a.gantt.fill),b.restore()},plot:function(a,b,c,d){var e=a.data;if(!(e.length<1)){var f=a.xaxis,g=a.yaxis,h=this.ctx,i;for(i=0;i<e.length;i++){var j=e[i][0],k=e[i][1],l=e[i][2],m=!0,n=!0,o=!0;if(k===null||l===null)continue;var p=k,q=k+l,r=j-(a.gantt.centered?b/2:0),s=j+b-(a.gantt.centered?b/2:0);if(q<f.min||p>f.max||s<g.min||r>g.max)continue;p<f.min&&(p=f.min,m=!1),q>f.max&&(q=f.max,f.lastSerie!=a&&(n=!1)),r<g.min&&(r=g.min),s>g.max&&(s=g.max,g.lastSerie!=a&&(n=!1)),d&&(h.beginPath(),h.moveTo(f.d2p(p),g.d2p(r)+c),h.lineTo(f.d2p(p),g.d2p(s)+c),h.lineTo(f.d2p(q),g.d2p(s)+c),h.lineTo(f.d2p(q),g.d2p(r)+c),h.fill(),h.closePath()),a.gantt.lineWidth!=0&&(m||o||n)&&(h.beginPath(),h.moveTo(f.d2p(p),g.d2p(r)+c),h[m?"lineTo":"moveTo"](f.d2p(p),g.d2p(s)+c),h[n?"lineTo":"moveTo"](f.d2p(q),g.d2p(s)+c),h[o?"lineTo":"moveTo"](f.d2p(q),g.d2p(r)+c),h.stroke(),h.closePath())}}},plotShadows:function(a,b,c){var d=a.data;if(!(d.length<1)){var e,f,g,h,i=a.xaxis,j=a.yaxis,k=this.ctx,l=this.options.shadowSize;for(e=0;e<d.length;e++){f=d[e][0],g=d[e][1],h=d[e][2];if(g===null||h===null)continue;var m=g,n=g+h,o=f-(a.gantt.centered?b/2:0),p=f+b-(a.gantt.centered?b/2:0);if(n<i.min||m>i.max||p<j.min||o>j.max)continue;m<i.min&&(m=i.min),n>i.max&&(n=i.max),o<j.min&&(o=j.min),p>j.max&&(p=j.max);var q=i.d2p(n)-i.d2p(m)-(i.d2p(n)+l<=this.plotWidth?0:l),r=j.d2p(o)-j.d2p(p)-(j.d2p(o)+l<=this.plotHeight?0:l);k.fillStyle="rgba(0,0,0,0.05)",k.fillRect(Math.min(i.d2p(m)+l,this.plotWidth),Math.min(j.d2p(p)+l,this.plotHeight),q,r)}}},extendXRange:function(a){if(a.options.max==null){var b=a.min,c=a.max,d,e,f,g,h,i={},j={},k=null;for(d=0;d<this.series.length;++d){g=this.series[d],h=g.gantt;if(h.show&&g.xaxis==a){for(e=0;e<g.data.length;e++)h.show&&(y=g.data[e][0]+"",i[y]=Math.max(i[y]||0,g.data[e][1]+g.data[e][2]),k=g);for(e in i)c=Math.max(i[e],c)}}a.lastSerie=k,a.max=c,a.min=b}},extendYRange:function(a){if(a.options.max==null){var b=Number.MIN_VALUE,c=Number.MAX_VALUE,d,e,f,g,h={},i={},j=null;for(d=0;d<this.series.length;++d){f=this.series[d],g=f.gantt;if(g.show&&!f.hide&&f.yaxis==a){var k=Number.MIN_VALUE,l=Number.MAX_VALUE;for(e=0;e<f.data.length;e++)k=Math.max(k,f.data[e][0]),l=Math.min(l,f.data[e][0]);g.centered?(b=Math.max(k+.5,b),c=Math.min(l-.5,c)):(b=Math.max(k+1,b),c=Math.min(l,c)),g.barWidth+k>b&&(b=a.max+g.barWidth)}}a.lastSerie=j,a.max=b,a.min=c,a.tickSize=Flotr.getTickSize(a.options.noTicks,c,b,a.options.tickDecimals)}}}),Flotr.defaultMarkerFormatter=function(a){return Math.round(a.y*100)/100+""},Flotr.addType("markers",{options:{show:!1,lineWidth:1,fill:!1,fillColor:"#FFFFFF",fillOpacity:.4,stroke:!1,position:"ct",labelFormatter:Flotr.defaultMarkerFormatter,fontSize:Flotr.defaultOptions.fontSize,stacked:!1,stackingType:"b",horizontal:!1},draw:function(a){a=a||this.series;var b=this.ctx,c=a.xaxis,d=a.yaxis,e=a.markers,f=a.data;b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.lineJoin="round",b.lineWidth=e.lineWidth,b.strokeStyle="rgba(0,0,0,0.5)",b.fillStyle=this.processColor(e.fillColor,{opacity:e.fillOpacity});for(var g=0;g<f.length;++g){var h=f[g][0],i=f[g][1],j;if(a.markers.stacked)if(a.markers.stackingType=="b"){var k=0,l=0;a.markers.horizontal?(k=d.values[i].stackMarkPos||0,l=d.values[i].stackMarkNeg||0,h>0?(d.values[i].stackMarkPos=k+h,h=k+h):(d.values[i].stackMarkNeg=l+h,h=l+h)):(k=c.values[h].stackMarkPos||0,l=c.values[h].stackMarkNeg||0,i>0?(c.values[h].stackMarkPos=k+i,i=k+i):(c.values[h].stackMarkNeg=l+i,i=l+i))}else if(a.markers.stackingType=="a"){var m=c.values[h].stackMark||0;c.values[h].stackMark=m+i,i=m+i}var n=c.d2p(h),o=d.d2p(i);j=e.labelFormatter({x:h,y:i,index:g,data:f}),this.markers.plot(n,o,j,e)}b.restore()},plot:function(a,b,c,d){var e=this.ctx,f=this.getTextDimensions(c,null,null),g=2,h=a,i=b;f.width=Math.floor(f.width+g*2),f.height=Math.floor(f.height+g*2),d.position.indexOf("c")!=-1?h-=f.width/2+g:d.position.indexOf("l")!=-1&&(h-=f.width),d.position.indexOf("m")!=-1?i-=f.height/2+g:d.position.indexOf("t")!=-1&&(i-=f.height),h=Math.floor(h)+.5,i=Math.floor(i)+.5,d.fill&&e.fillRect(h,i,f.width,f.height),d.stroke&&e.strokeRect(h,i,f.width,f.height),Flotr.drawText(e,c,h+g,i+g,{textBaseline:"top",textAlign:"left",size:d.fontSize})}}),Flotr.defaultPieLabelFormatter=function(a){return(a.fraction*100).toFixed(2)+"%"},Flotr.addType("pie",{options:{show:!1,lineWidth:1,fill:!0,fillColor:null,fillOpacity:.6,explode:6,sizeRatio:.6,startAngle:Math.PI/4,labelFormatter:Flotr.defaultPieLabelFormatter,pie3D:!1,pie3DviewAngle:Math.PI/2*.8,pie3DspliceThickness:20},draw:function(a){if(!this.options.pie.drawn){var b=this.ctx,c=this.options,d=a.pie.lineWidth,e=a.shadowSize,f=a.data,g=this.plotOffset,h=Math.min(this.canvasWidth,this.canvasHeight)*a.pie.sizeRatio/2,i=[],j=1,k=Math.sin(a.pie.viewAngle)*a.pie.spliceThickness/j,l={size:c.fontSize*1.2,color:c.grid.color,weight:1.5},m={x:g.left+this.plotWidth/2,y:g.top+this.plotHeight/2},n=this.pie._getPortions(),o=this.pie._getSlices(n,a);b.save(),e>0&&_.each(o,function(c){if(c.startAngle!=c.endAngle){var d=(c.startAngle+c.endAngle)/2,f=m.x+Math.cos(d)*c.options.explode+e,g=m.y+Math.sin(d)*c.options.explode+e;this.pie.plotSlice(f,g,h,c.startAngle,c.endAngle,!1,j),a.pie.fill&&(b.fillStyle="rgba(0,0,0,0.1)",b.fill())}},this);if(c.HtmlText||!this.textEnabled)i=[];_.each(o,function(e,f){if(e.startAngle!=e.endAngle){var g=(e.startAngle+e.endAngle)/2,k=e.series.color,n=e.options.fillColor||k,o=m.x+Math.cos(g)*e.options.explode,p=m.y+Math.sin(g)*e.options.explode;this.pie.plotSlice(o,p,h,e.startAngle,e.endAngle,!1,j),a.pie.fill&&(b.fillStyle=this.processColor(n,{opacity:a.pie.fillOpacity}),b.fill()),b.lineWidth=d,b.strokeStyle=k,b.stroke();var q=c.pie.labelFormatter(e),r=Math.cos(g)<0,s=Math.sin(g)>0,t=(e.options.explode||a.pie.explode)+h+4,u=m.x+Math.cos(g)*t,v=m.y+Math.sin(g)*t;if(e.fraction&&q)if(c.HtmlText||!this.textEnabled){var w=s?v-5:this.plotHeight-v+5,x="position:absolute;"+(s?"top":"bottom")+":"+w+"px;";r?x+="right:"+(this.canvasWidth-u)+"px;text-align:right;":x+="left:"+u+"px;text-align:left;",i.push('<div style="',x,'" class="flotr-grid-label">',q,"</div>")}else l.textAlign=r?"right":"left",l.textBaseline=s?"top":"bottom",Flotr.drawText(b,q,u,v,l)}},this);if(c.HtmlText||!this.textEnabled){var p=Flotr.DOM.node('<div style="color:'+this.options.grid.color+'" class="flotr-labels"></div>');Flotr.DOM.insert(p,i.join("")),Flotr.DOM.insert(this.el,p)}b.restore(),c.pie.drawn=!0}},plotSlice:function(a,b,c,d,e,f,g){var h=this.ctx;g=g||1,h.scale(1,g),h.beginPath(),h.moveTo(a,b),h.arc(a,b,c,d,e,f),h.lineTo(a,b),h.closePath()},hit:function(a,b){function m(a){return a>0?a:a+2*Math.PI}var c=this.series,d=this.options,e=Math.min(this.canvasWidth,this.canvasHeight)*d.pie.sizeRatio/2,f=1,g=d.pie.startAngle,h,j,k,l;h={x:this.plotWidth/2,y:this.plotHeight/2},portions=this.pie._getPortions(),slices=this.pie._getSlices(portions,c,g);for(i=0;i<c.length;i++){j=c[i],k=j.data[0][0],l=j.data[0][1];if(l===null)continue;var n=a.relX-h.x,o=a.relY-h.y,p=Math.sqrt(Math.pow(n,2)+Math.pow(o,2)),q=m(slices[i].startAngle%(2*Math.PI)),r=m(slices[i].endAngle%(2*Math.PI)),s=o/p,t=m(Math.asin(s)%(2*Math.PI)),u=Math.asin(-s)+Math.PI;p<e+10&&(n>0&&q<t&&r>t||n<0&&q<u&&r>u||(q>r||slices[i].fraction==1)&&(n>0&&(q<t||r>t)||n<0&&(q<u||r>u)))&&(b.x=k,b.y=l,b.sAngle=q,b.eAngle=r,b.mouse=j.mouse,b.series=j,b.allSeries=c,b.seriesIndex=i,b.fraction=slices[i].fraction)}},drawHit:function(a){var b=this.octx,c=a.series,d=a.xaxis,e=a.yaxis;b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),b.beginPath();if(c.mouse.trackAll)b.moveTo(d.d2p(a.x),e.d2p(0)),b.lineTo(d.d2p(a.x),e.d2p(a.yaxis.max));else{var f={x:this.plotWidth/2,y:this.plotHeight/2},g=Math.min(this.canvasWidth,this.canvasHeight)*c.pie.sizeRatio/2,h=a.sAngle<a.eAngle?(a.sAngle+a.eAngle)/2:(a.sAngle+a.eAngle+2*Math.PI)/2,i=f.x+Math.cos(h)*a.series.pie.explode,j=f.y+Math.sin(h)*a.series.pie.explode;b.beginPath(),b.moveTo(i,j),a.fraction!=1?b.arc(i,j,g,a.sAngle,a.eAngle,!1):b.arc(i,j,g,a.sAngle,a.eAngle-1e-5,!1),b.lineTo(i,j),b.closePath()}b.stroke(),b.closePath(),b.restore()},clearHit:function(){var a={x:this.plotOffset.left+this.plotWidth/2,y:this.plotOffset.top+this.plotHeight/2},b=this.prevHit.series.pie,c=Math.min(this.canvasWidth,this.canvasHeight)*b.sizeRatio/2,d=(b.explode+b.lineWidth)*4;this.octx.clearRect(a.x-c-d,a.y-c-d,2*(c+d),2*(c+d))},_getPortions:function(){return _.map(this.series,function(a,b){if(a.pie.show&&a.data[0][1]!==null)return{name:a.label||a.data[0][1],value:[b,a.data[0][1]],options:a.pie,series:a}})},_getSum:function(a){return _.inject(_.pluck(_.pluck(a,"value"),1),function(a,b){return a+b},0)},_getSlices:function(a,b,c){var d=this.pie._getSum(a),e=0,f=_.isUndefined(c)?b.pie.startAngle:c,g=0;return _.map(a,function(a){f+=e,g=parseFloat(a.value[1]),e=g/d;return{name:a.name,fraction:e,x:a.value[0],y:g,value:g,options:a.options,series:a.series,startAngle:2*f*Math.PI,endAngle:2*(f+e)*Math.PI}})}}),Flotr.addType("points",{options:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#FFFFFF",fillOpacity:.4},draw:function(a){var b=this.ctx,c=a.lines.lineWidth,d=a.shadowSize;b.save(),b.translate(this.plotOffset.left,this.plotOffset.top),d>0&&(b.lineWidth=d/2,b.strokeStyle="rgba(0,0,0,0.1)",this.points.plotShadows(a,d/2+b.lineWidth/2,a.points.radius),b.strokeStyle="rgba(0,0,0,0.2)",this.points.plotShadows(a,b.lineWidth/2,a.points.radius)),b.lineWidth=a.points.lineWidth,b.strokeStyle=a.color,b.fillStyle=a.points.fillColor?a.points.fillColor:a.color,this.points.plot(a,a.points.radius,a.points.fill),b.restore()},plot:function(a,b,c){var d=a.xaxis,e=a.yaxis,f=this.ctx,g=a.data,h,i,j;for(h=g.length-1;h>-1;--h){i=g[h][0],j=g[h][1];if(j===null||i<d.min||i>d.max||j<e.min||j>e.max)continue;f.beginPath(),f.arc(d.d2p(i),e.d2p(j),b,0,2*Math.PI,!0),c&&f.fill(),f.stroke(),f.closePath()}},plotShadows:function(a,b,c){var d=a.xaxis,e=a.yaxis,f=this.ctx,g=a.data,h,i,j;for(h=g.length-1;h>-1;--h){i=g[h][0],j=g[h][1];if(j===null||i<d.min||i>d.max||j<e.min||j>e.max)continue;f.beginPath(),f.arc(d.d2p(i),e.d2p(j)+b,c,0,Math.PI,!1),f.stroke(),f.closePath()}},getHit:function(a,b){var c,d,e,f,g,h,i,j=a.points,k=a.data,l=a.mouse.sensibility*(j.lineWidth+j.radius),m={index:null,series:a,distance:Number.MAX_VALUE,x:null,y:null,precision:1};for(e=k.length-1;e>-1;--e)f=k[e],h=a.xaxis.d2p(f[0]),i=a.yaxis.d2p(f[1]),c=h-b.relX,d=i-b.relY,g=Math.sqrt(c*c+d*d),g<l&&g<m.distance&&(m={index:e,series:a,distance:g,data:f,x:h,y:i,precision:1});return m},drawHit:function(a,b){},clearHit:function(a,b){}}),Flotr.addType("radar",{options:{show:!1,lineWidth:2,fill:!0,fillOpacity:.4,radiusRatio:.9},draw:function(a){var b=this.ctx,c=this.options;b.save(),b.translate(this.plotOffset.left+this.plotWidth/2,this.plotOffset.top+this.plotHeight/2),b.lineWidth=a.radar.lineWidth,b.fillStyle="rgba(0,0,0,0.05)",b.strokeStyle="rgba(0,0,0,0.05)",this.radar.plot(a,a.shadowSize/2),b.strokeStyle="rgba(0,0,0,0.1)",this.radar.plot(a,a.shadowSize/4),b.strokeStyle=a.color,b.fillStyle=this.processColor(a.color,{opacity:a.radar.fillOpacity}),this.radar.plot(a),b.restore()},plot:function(a,b){var c=this.ctx,d=this.options,e=a.data,f=Math.min(this.plotHeight,this.plotWidth)*d.radar.radiusRatio/2,g=2*(Math.PI/e.length),h=-Math.PI/2;b=b||0,c.beginPath();for(var i=0;i<e.length;++i){var j=e[i][0],k=e[i][1],l=k/this.axes.y.max;c[i==0?"moveTo":"lineTo"](Math.cos(i*g+h)*f*l+b,Math.sin(i*g+h)*f*l+b)}c.closePath(),a.radar.fill&&c.fill(),c.stroke()}}),function(){var a=Flotr.DOM;Flotr.addPlugin("legend",{options:{show:!0,noColumns:1,labelFormatter:function(a){return a},labelBoxBorderColor:"#CCCCCC",labelBoxWidth:14,labelBoxHeight:10,labelBoxMargin:5,labelBoxOpacity:.4,container:null,position:"nw",margin:5,backgroundColor:null,backgroundOpacity:.85},callbacks:{"flotr:afterinit":function(){this.legend.insertLegend()}},insertLegend:function(){if(!!this.options.legend.show){var b=this.series,c=this.plotOffset,d=this.options,e=d.legend,f=[],g=!1,h=this.ctx,i=_.filter(b,function(a){return a.label&&!a.hide}).length,j=e.position,k=e.margin,l,m,n;if(i)if(!d.HtmlText&&this.textEnabled&&!e.container){var o={size:d.fontSize*1.1,color:d.grid.color},p=e.labelBoxWidth,q=e.labelBoxHeight,r=e.labelBoxMargin,s=c.left+k,t=c.top+k,u=0;for(l=b.length-1;l>-1;--l){if(!b[l].label||b[l].hide)continue;m=e.labelFormatter(b[l].label),u=Math.max(u,Flotr.measureText(h,m,o).width)}var v=Math.round(p+r*3+u),w=Math.round(i*(r+q)+r);j.charAt(0)=="s"&&(t=c.top+this.plotHeight-(k+w)),j.charAt(1)=="e"&&(s=c.left+this.plotWidth-(k+v)),n=this.processColor(e.backgroundColor||"rgb(240,240,240)",{opacity:e.backgroundOpacity||.1}),h.fillStyle=n,h.fillRect(s,t,v,w),h.strokeStyle=e.labelBoxBorderColor,h.strokeRect(Flotr.toPixel(s),Flotr.toPixel(t),v,w);var x=s+r,y=t+r;for(l=0;l<b.length;l++){if(!b[l].label||b[l].hide)continue;m=e.labelFormatter(b[l].label),h.fillStyle=b[l].color,h.fillRect(x,y,p-1,q-1),h.strokeStyle=e.labelBoxBorderColor,h.lineWidth=1,h.strokeRect(Math.ceil(x)-1.5,Math.ceil(y)-1.5,p+2,q+2),Flotr.drawText(h,m,x+p+r,y+(q+o.size-h.fontDescent(o))/2,o),y+=q+r}}else{for(l=0;l<b.length;++l){if(!b[l].label||b[l].hide)continue;l%e.noColumns===0&&(f.push(g?"</tr><tr>":"<tr>"),g=!0);var z=b[l],A=e.labelBoxWidth,B=e.labelBoxHeight,C=z.bars?z.bars.fillOpacity:e.labelBoxOpacity,E="opacity:"+C+";filter:alpha(opacity="+C*100+");";m=e.labelFormatter(z.label),n="background-color:"+(z.bars&&z.bars.show&&z.bars.fillColor&&z.bars.fill?z.bars.fillColor:z.color)+";",f.push('<td class="flotr-legend-color-box">','<div style="border:1px solid ',e.labelBoxBorderColor,';padding:1px">','<div style="width:',A-1,"px;height:",B-1,"px;border:1px solid ",b[l].color,'">','<div style="width:',A,"px;height:",B,"px;","opacity:.4;",n,'"></div>',"</div>","</div>","</td>",'<td class="flotr-legend-label">',m,"</td>")}g&&f.push("</tr>");if(f.length>0){var F='<table style="font-size:smaller;color:'+d.grid.color+'">'+f.join("")+"</table>";if(e.container)a.insert(e.container,F);else{var G={position:"absolute","z-index":2};j.charAt(0)=="n"?(G.top=k+c.top+"px",G.bottom="auto"):j.charAt(0)=="s"&&(G.bottom=k+c.bottom+"px",G.top="auto"),j.charAt(1)=="e"?(G.right=k+c.right+"px",G.left="auto"):j.charAt(1)=="w"&&(G.left=k+c.left+"px",G.right="auto");var H=a.create("div"),I;H.className="flotr-legend",a.setStyles(H,G),a.insert(H,F),a.insert(this.el,H);if(e.backgroundOpacity!==0)return;var J=e.backgroundColor;if(!J){var K=d.grid.backgroundColor?d.grid.backgroundColor:Flotr.Color.extract(H);J=this.processColor(K,null,{opacity:1})}J="#ff00ff",_.extend(G,a.size(H),{backgroundColor:J,"z-index":1}),G.width+="px",G.height+="px",H=a.create("div"),H.className="flotr-legend-bg",a.setStyles(H,G),a.opacity(H,e.backgroundOpacity),a.insert(H," "),a.insert(this.el,H)}}}}}})}(),function(){var a=Flotr.DOM;Flotr.addPlugin("spreadsheet",{options:{show:!1,tabGraphLabel:"Graph",tabDataLabel:"Data",toolbarDownload:"Download CSV",toolbarSelectAll:"Select all",csvFileSeparator:",",decimalSeparator:".",tickFormatter:null},callbacks:{"flotr:afterconstruct":function(){if(!!this.options.spreadsheet.show){var b=this.spreadsheet,c=a.node('<div class="flotr-tabs-group" style="position:absolute;left:0px;width:'+this.canvasWidth+'px"></div>'),d=a.node('<div style="float:left" class="flotr-tab selected">'+this.options.spreadsheet.tabGraphLabel+"</div>"),e=a.node('<div style="float:left" class="flotr-tab">'+this.options.spreadsheet.tabDataLabel+"</div>"),f;b.tabsContainer=c,b.tabs={graph:d,data:e},a.insert(c,d),a.insert(c,e),a.insert(this.el,c),f=a.size(e).height+2,this.plotOffset.bottom+=f,a.setStyles(c,{top:this.canvasHeight-f+"px"}),Flotr.EventAdapter.observe(d,"click",function(){b.showTab("graph")}).observe(e,"click",function(){b.showTab("data")});return}}},loadDataGrid:function(){if(this.seriesData)return this.seriesData;var a=this.series,b=[];for(i=0;i<a.length;++i)_.each(a[i].data,function(a){var c=a[0],d=a[1],e=_.detect(b,function(a){return a[0]==c});if(e)e[i+1]=d;else{var f=[];f[0]=c,f[i+1]=d,b.push(f)}});this.seriesData=_.sortBy(b,function(a){return a[0]});return this.seriesData},constructDataGrid:function(){if(this.spreadsheet.datagrid)return this.spreadsheet.datagrid;var b,c,d=this.series,e=this.spreadsheet.loadDataGrid(),f=["<colgroup><col />"],g,h,i,j=['<table class="flotr-datagrid"><tr class="first-row">'];j.push("<th>&nbsp;</th>");for(b=0;b<d.length;++b)j.push('<th scope="col">'+(d[b].label||String.fromCharCode(65+b))+"</th>"),f.push("<col />");j.push("</tr>");for(c=0;c<e.length;++c){j.push("<tr>");for(b=0;b<d.length+1;++b){var k="td",l=e[c][b]!=null?Math.round(e[c][b]*1e5)/1e5:"";if(b==0){k="th";var m;if(this.options.xaxis.ticks){var n=this.options.xaxis.ticks.find(function(a){return a[0]==e[c][b]});n&&(m=n[1])}else this.options.spreadsheet.tickFormatter?m=this.options.spreadsheet.tickFormatter(l):m=this.options.xaxis.tickFormatter(l);m&&(l=m)}j.push("<"+k+(k=="th"?' scope="row"':"")+">"+l+"</"+k+">")}j.push("</tr>")}f.push("</colgroup>"),i=a.node(j.join("")),g=a.node('<button type="button" class="flotr-datagrid-toolbar-button">'+this.options.spreadsheet.toolbarDownload+"</button>"),h=a.node('<button type="button" class="flotr-datagrid-toolbar-button">'+this.options.spreadsheet.toolbarSelectAll+"</button>"),Flotr.EventAdapter.observe(g,"click",_.bind(this.spreadsheet.downloadCSV,this)).observe(h,"click",_.bind(this.spreadsheet.selectAllData,this));var o=a.node('<div class="flotr-datagrid-toolbar"></div>');a.insert(o,g),a.insert(o,h);var p=this.canvasHeight-a.size(this.spreadsheet.tabsContainer).height-2,q=a.node('<div class="flotr-datagrid-container" style="position:absolute;left:0px;top:0px;width:'+this.canvasWidth+"px;height:"+p+'px;overflow:auto;z-index:10"></div>');a.insert(q,o),a.insert(q,i),a.insert(this.el,q),this.spreadsheet.datagrid=i,this.spreadsheet.container=q;return i},showTab:function(b){var c="canvas, .flotr-labels, .flotr-legend, .flotr-legend-bg, .flotr-title, .flotr-subtitle";switch(b){case"graph":a.hide(this.spreadsheet.container),a.removeClass(this.spreadsheet.tabs.data,"selected"),a.addClass(this.spreadsheet.tabs.graph,"selected");break;case"data":this.spreadsheet.datagrid||this.spreadsheet.constructDataGrid(),a.show(this.spreadsheet.container),a.addClass(this.spreadsheet.tabs.data,"selected"),a.removeClass(this.spreadsheet.tabs.graph,"selected")}},selectAllData:function(){console.log("selectAllData");if(this.spreadsheet.tabs){var a,b,c,d,e=this.spreadsheet.constructDataGrid();this.spreadsheet.showTab("data"),setTimeout(function(){(c=e.ownerDocument)&&(d=c.defaultView)&&d.getSelection&&c.createRange&&(a=window.getSelection())&&a.removeAllRanges?(b=c.createRange(),b.selectNode(e),a.removeAllRanges(),a.addRange(b)):document.body&&document.body.createTextRange&&(b=document.body.createTextRange())&&(b.moveToElementText(e),b.select())},0);return!0}return!1},downloadCSV:function(){console.log("downloadCSV");var a,b="",c=this.series,d=this.options,e=this.spreadsheet.loadDataGrid(),f=encodeURIComponent(d.spreadsheet.csvFileSeparator);if(d.spreadsheet.decimalSeparator===d.spreadsheet.csvFileSeparator)throw"The decimal separator is the same as the column separator ("+d.spreadsheet.decimalSeparator+")";for(a=0;a<c.length;++a)b+=f+'"'+(c[a].label||String.fromCharCode(65+a)).replace(/\"/g,'\\"')+'"';b+="%0D%0A";for(a=0;a<e.length;++a){var g="";if(d.xaxis.ticks){var h=d.xaxis.ticks.find(function(b){return b[0]==e[a][0]});h&&(g=h[1])}else d.spreadsheet.tickFormatter?g=d.spreadsheet.tickFormatter(e[a][0]):g=d.xaxis.tickFormatter(e[a][0]);g='"'+(g+"").replace(/\"/g,'\\"')+'"';var i=e[a].slice(1).join(f);d.spreadsheet.decimalSeparator!=="."&&(i=i.replace(/\./g,d.spreadsheet.decimalSeparator)),b+=g+f+i+"%0D%0A"}Flotr.isIE&&Flotr.isIE<9?(b=b.replace(new RegExp(f,"g"),decodeURIComponent(f)).replace(/%0A/g,"\n").replace(/%0D/g,"\r"),window.open().document.write(b)):window.open("data:text/csv,"+b)}})}()